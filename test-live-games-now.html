<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèà LIVE College Football Games - RIGHT NOW</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: white; }
        .container { max-width: 1200px; margin: 0 auto; }
        .live-game { 
            border: 2px solid #ff4444; 
            margin: 15px 0; 
            padding: 20px; 
            border-radius: 8px; 
            background: linear-gradient(135deg, #2a1a1a, #1a2a1a);
            box-shadow: 0 4px 8px rgba(255, 68, 68, 0.3);
        }
        .scheduled-game { 
            border: 1px solid #666; 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 5px; 
            background: #2a2a2a; 
        }
        .completed-game { 
            border: 1px solid #4a4a4a; 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 5px; 
            background: #1a1a1a; 
            opacity: 0.8;
        }
        .score { font-size: 1.5em; font-weight: bold; color: #fff; margin: 10px 0; }
        .live-indicator { 
            color: #ff4444; 
            font-weight: bold; 
            font-size: 1.2em;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .status { color: #ccc; font-style: italic; margin: 5px 0; }
        .venue { color: #aaa; font-size: 0.9em; }
        .loading { text-align: center; padding: 40px; font-size: 1.2em; }
        .error { color: #ff6b6b; background: #2a1a1a; padding: 15px; border-radius: 5px; margin: 10px 0; border-left: 4px solid #ff6b6b; }
        .success { color: #51cf66; background: #1a2a1a; padding: 15px; border-radius: 5px; margin: 10px 0; border-left: 4px solid #51cf66; }
        .info { color: #74c0fc; background: #1a1a2a; padding: 15px; border-radius: 5px; margin: 10px 0; border-left: 4px solid #74c0fc; }
        h1 { color: #ff4444; text-align: center; font-size: 2.5em; margin-bottom: 10px; }
        h2 { color: #fff; border-bottom: 2px solid #ff4444; padding-bottom: 10px; }
        .btn { 
            padding: 12px 24px; 
            margin: 8px; 
            background: linear-gradient(135deg, #ff4444, #cc3333); 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 1em;
            font-weight: bold;
        }
        .btn:hover { background: linear-gradient(135deg, #cc3333, #aa2222); }
        .current-time { 
            text-align: center; 
            font-size: 1.1em; 
            color: #ccc; 
            margin-bottom: 20px;
            background: #2a2a2a;
            padding: 10px;
            border-radius: 5px;
        }
        .api-status { margin: 20px 0; }
        .team-name { font-weight: bold; }
        .home-team { color: #74c0fc; }
        .away-team { color: #ffd43b; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèà LIVE College Football Games</h1>
        <div class="current-time">
            <div>Current Time: <span id="current-time"></span></div>
            <div>Date: <span id="current-date"></span></div>
        </div>
        
        <div style="text-align: center; margin: 20px 0;">
            <button class="btn" onclick="checkLiveGamesNow()">üî¥ CHECK LIVE GAMES NOW</button>
            <button class="btn" onclick="testESPNAPI()">üì° TEST ESPN API</button>
            <button class="btn" onclick="checkAllAPIs()">üîç CHECK ALL APIS</button>
        </div>
        
        <div id="api-status" class="api-status"></div>
        <div id="games-container"></div>
    </div>

    <script>
        // Update current time every second
        function updateTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = now.toLocaleTimeString();
            document.getElementById('current-date').textContent = now.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }
        updateTime();
        setInterval(updateTime, 1000);

        function addStatus(message, type = 'info') {
            const statusDiv = document.getElementById('api-status');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            statusDiv.appendChild(div);
            
            // Auto-scroll to latest status
            div.scrollIntoView({ behavior: 'smooth' });
        }

        async function checkLiveGamesNow() {
            addStatus('üîç Checking for LIVE college football games RIGHT NOW...', 'info');
            
            const today = new Date();
            const dateStr = today.toISOString().slice(0, 10).replace(/-/g, '');
            
            // Multiple ESPN endpoints to try
            const endpoints = [
                `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=${dateStr}`,
                `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard`,
                `https://sports.core.api.espn.com/v2/sports/football/leagues/college-football/events?dates=${dateStr}`
            ];
            
            for (let i = 0; i < endpoints.length; i++) {
                const endpoint = endpoints[i];
                addStatus(`üì° Trying ESPN API ${i + 1}/3: ${endpoint}`, 'info');
                
                try {
                    // Use proxy to avoid CORS issues
                    const proxyUrl = `/api/proxy?url=${encodeURIComponent(endpoint)}`;
                    const response = await fetch(proxyUrl);
                    
                    if (response.ok) {
                        const data = await response.json();
                        
                        if (data && data.events && data.events.length > 0) {
                            addStatus(`‚úÖ SUCCESS! Found ${data.events.length} games from ESPN API ${i + 1}`, 'success');
                            displayESPNGames(data.events);
                            return; // Success, stop trying other endpoints
                        } else {
                            addStatus(`‚ö†Ô∏è ESPN API ${i + 1} returned no games`, 'error');
                        }
                    } else {
                        addStatus(`‚ùå ESPN API ${i + 1} failed: ${response.status} ${response.statusText}`, 'error');
                    }
                } catch (error) {
                    addStatus(`‚ùå ESPN API ${i + 1} error: ${error.message}`, 'error');
                }
            }
            
            // If all APIs failed, show fallback message
            addStatus('‚ùå All ESPN APIs failed. This might be due to:', 'error');
            addStatus('‚Ä¢ College football season not started yet', 'info');
            addStatus('‚Ä¢ No games scheduled for today', 'info');
            addStatus('‚Ä¢ ESPN API temporarily down', 'info');
            addStatus('‚Ä¢ CORS/proxy issues', 'info');
            
            showFallbackGames();
        }

        async function testESPNAPI() {
            addStatus('üß™ Testing ESPN API connectivity...', 'info');
            
            const today = new Date();
            const dateStr = today.toISOString().slice(0, 10).replace(/-/g, '');
            const testUrl = `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=${dateStr}`;
            
            addStatus(`üì° Testing URL: ${testUrl}`, 'info');
            
            try {
                const proxyUrl = `/api/proxy?url=${encodeURIComponent(testUrl)}`;
                addStatus(`üì° Using proxy: ${proxyUrl}`, 'info');
                
                const response = await fetch(proxyUrl);
                addStatus(`üìä Response status: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    addStatus(`üìä Response data type: ${typeof data}`, 'info');
                    addStatus(`üìä Has events: ${!!(data && data.events)}`, 'info');
                    addStatus(`üìä Events count: ${data && data.events ? data.events.length : 0}`, 'info');
                    
                    if (data && data.events) {
                        addStatus(`‚úÖ ESPN API is working! Found ${data.events.length} events`, 'success');
                        
                        // Show raw data structure
                        console.log('ESPN API Response:', data);
                        addStatus('üìã Check browser console for full API response', 'info');
                        
                        if (data.events.length > 0) {
                            displayESPNGames(data.events);
                        }
                    } else {
                        addStatus('‚ö†Ô∏è ESPN API returned unexpected data structure', 'error');
                    }
                } else {
                    const errorText = await response.text();
                    addStatus(`‚ùå API Error: ${errorText}`, 'error');
                }
            } catch (error) {
                addStatus(`‚ùå Network Error: ${error.message}`, 'error');
                console.error('ESPN API Test Error:', error);
            }
        }

        async function checkAllAPIs() {
            addStatus('üîç Testing ALL available college football APIs...', 'info');
            
            const today = new Date();
            const dateStr = today.toISOString().slice(0, 10).replace(/-/g, '');
            
            const apis = [
                {
                    name: 'ESPN Scoreboard',
                    url: `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=${dateStr}`
                },
                {
                    name: 'ESPN Scoreboard (No Date)',
                    url: 'https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard'
                },
                {
                    name: 'ESPN Events API',
                    url: `https://sports.core.api.espn.com/v2/sports/football/leagues/college-football/events?dates=${dateStr}`
                },
                {
                    name: 'NCAA API',
                    url: 'https://ncaa-api.henrygd.me/scoreboard/football/fbs/2024/1/all-conf'
                }
            ];
            
            for (const api of apis) {
                addStatus(`üì° Testing ${api.name}...`, 'info');
                
                try {
                    const proxyUrl = `/api/proxy?url=${encodeURIComponent(api.url)}`;
                    const response = await fetch(proxyUrl);
                    
                    if (response.ok) {
                        const data = await response.json();
                        const gameCount = (data.events && data.events.length) || (data.games && data.games.length) || 0;
                        
                        if (gameCount > 0) {
                            addStatus(`‚úÖ ${api.name}: Found ${gameCount} games!`, 'success');
                            
                            if (data.events) {
                                displayESPNGames(data.events);
                            } else if (data.games) {
                                displayNCAAGames(data.games);
                            }
                        } else {
                            addStatus(`‚ö†Ô∏è ${api.name}: No games found`, 'error');
                        }
                    } else {
                        addStatus(`‚ùå ${api.name}: HTTP ${response.status}`, 'error');
                    }
                } catch (error) {
                    addStatus(`‚ùå ${api.name}: ${error.message}`, 'error');
                }
            }
        }

        function displayESPNGames(events) {
            const container = document.getElementById('games-container');
            container.innerHTML = '<h2>üèà College Football Games Found</h2>';
            
            if (!events || events.length === 0) {
                container.innerHTML += '<div class="info">No games found in ESPN data.</div>';
                return;
            }
            
            let liveCount = 0;
            let scheduledCount = 0;
            let completedCount = 0;
            
            events.forEach(event => {
                const competition = event.competitions && event.competitions[0];
                if (!competition) return;
                
                const homeTeam = competition.competitors?.find(c => c.homeAway === 'home');
                const awayTeam = competition.competitors?.find(c => c.homeAway === 'away');
                
                const isLive = event.status?.type?.name === 'STATUS_IN_PROGRESS';
                const isCompleted = event.status?.type?.completed;
                
                if (isLive) liveCount++;
                else if (isCompleted) completedCount++;
                else scheduledCount++;
                
                const gameClass = isLive ? 'live-game' : (isCompleted ? 'completed-game' : 'scheduled-game');
                const liveIndicator = isLive ? '<div class="live-indicator">üî¥ LIVE NOW</div>' : '';
                
                const gameDiv = document.createElement('div');
                gameDiv.className = gameClass;
                gameDiv.innerHTML = `
                    ${liveIndicator}
                    <div class="score">
                        <span class="away-team team-name">${awayTeam?.team?.displayName || 'Away Team'}</span>
                        <strong>${awayTeam?.score || 0}</strong>
                        -
                        <strong>${homeTeam?.score || 0}</strong>
                        <span class="home-team team-name">${homeTeam?.team?.displayName || 'Home Team'}</span>
                    </div>
                    <div class="status">
                        Status: ${event.status?.type?.description || 'Unknown'} 
                        ${event.status?.displayClock ? '‚Ä¢ ' + event.status.displayClock : ''}
                    </div>
                    <div class="venue">
                        üìç ${competition.venue?.fullName || 'Venue TBD'} ‚Ä¢ 
                        üìÖ ${new Date(event.date).toLocaleString()}
                    </div>
                `;
                
                container.appendChild(gameDiv);
            });
            
            // Add summary
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'info';
            summaryDiv.innerHTML = `
                <strong>üìä Games Summary:</strong> 
                ${liveCount} Live ‚Ä¢ ${scheduledCount} Scheduled ‚Ä¢ ${completedCount} Completed
            `;
            container.insertBefore(summaryDiv, container.firstChild.nextSibling);
        }

        function displayNCAAGames(games) {
            const container = document.getElementById('games-container');
            container.innerHTML = '<h2>üèà NCAA API Games Found</h2>';
            
            games.forEach(game => {
                const gameDiv = document.createElement('div');
                gameDiv.className = 'scheduled-game';
                gameDiv.innerHTML = `
                    <div class="score">
                        <span class="away-team team-name">${game.away_team || 'Away Team'}</span>
                        <strong>${game.away_score || 0}</strong>
                        -
                        <strong>${game.home_score || 0}</strong>
                        <span class="home-team team-name">${game.home_team || 'Home Team'}</span>
                    </div>
                    <div class="status">Status: ${game.status || 'Scheduled'}</div>
                    <div class="venue">üìç ${game.venue || 'Venue TBD'}</div>
                `;
                container.appendChild(gameDiv);
            });
        }

        function showFallbackGames() {
            const container = document.getElementById('games-container');
            container.innerHTML = '<h2>üèà Fallback College Football Games (Week 1)</h2>';
            
            const fallbackGames = [
                {
                    name: 'Georgia Bulldogs vs Clemson Tigers',
                    homeTeam: 'Clemson Tigers',
                    awayTeam: 'Georgia Bulldogs',
                    homeScore: 21,
                    awayScore: 24,
                    status: 'Live - 4th Quarter 8:42',
                    venue: 'Mercedes-Benz Stadium (Atlanta)',
                    isLive: true
                },
                {
                    name: 'Alabama Crimson Tide vs Wisconsin Badgers',
                    homeTeam: 'Wisconsin Badgers',
                    awayTeam: 'Alabama Crimson Tide',
                    homeScore: 14,
                    awayScore: 28,
                    status: 'Live - 3rd Quarter 12:15',
                    venue: 'Soldier Field (Chicago)',
                    isLive: true
                },
                {
                    name: 'Ohio State Buckeyes vs Indiana Hoosiers',
                    homeTeam: 'Ohio State Buckeyes',
                    awayTeam: 'Indiana Hoosiers',
                    homeScore: 35,
                    awayScore: 10,
                    status: 'Final',
                    venue: 'Ohio Stadium (Columbus)',
                    isLive: false
                }
            ];
            
            fallbackGames.forEach(game => {
                const gameClass = game.isLive ? 'live-game' : 'completed-game';
                const liveIndicator = game.isLive ? '<div class="live-indicator">üî¥ LIVE NOW</div>' : '';
                
                const gameDiv = document.createElement('div');
                gameDiv.className = gameClass;
                gameDiv.innerHTML = `
                    ${liveIndicator}
                    <div class="score">
                        <span class="away-team team-name">${game.awayTeam}</span>
                        <strong>${game.awayScore}</strong>
                        -
                        <strong>${game.homeScore}</strong>
                        <span class="home-team team-name">${game.homeTeam}</span>
                    </div>
                    <div class="status">Status: ${game.status}</div>
                    <div class="venue">üìç ${game.venue}</div>
                `;
                container.appendChild(gameDiv);
            });
            
            const noteDiv = document.createElement('div');
            noteDiv.className = 'info';
            noteDiv.innerHTML = '<strong>Note:</strong> These are realistic fallback games since live API data is not available.';
            container.appendChild(noteDiv);
        }

        // Auto-check on page load
        window.addEventListener('load', function() {
            setTimeout(() => {
                addStatus('üöÄ Page loaded. Ready to check live games!', 'success');
                checkLiveGamesNow();
            }, 1000);
        });
    </script>
</body>
</html>