<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCAA AI Enhancements Test - Sunday Edge Pro</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .section {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .section h2 {
            color: #00ff88;
            margin-top: 0;
        }
        .loading {
            color: #ffa500;
            font-style: italic;
        }
        .error {
            color: #ff4444;
            background: rgba(255, 68, 68, 0.1);
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
            padding: 10px;
            border-radius: 4px;
        }
        .game-card {
            background: #333;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }
        .ai-section {
            background: #2a2a3a;
            border: 1px solid #6666ff;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
        }
        .betting-section {
            background: #2a3a2a;
            border: 1px solid #66ff66;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
        }
        .ml-section {
            background: #3a2a2a;
            border: 1px solid #ff6666;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
        }
        .confidence-high { color: #00ff00; }
        .confidence-medium { color: #ffaa00; }
        .confidence-low { color: #ff4444; }
        .btn {
            background: #00ff88;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #00cc6a;
        }
        pre {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 10px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèà NCAA AI Enhancements Test - Sunday Edge Pro</h1>
        <p>Testing comprehensive AI predictions, betting lines, and ML algorithms for college football</p>
        
        <div class="section">
            <h2>üîß Service Status</h2>
            <div id="service-status" class="loading">Initializing NCAA Data Service...</div>
        </div>
        
        <div class="section">
            <h2>üß† AI Predictions Test</h2>
            <button class="btn" onclick="testAIPredictions()">Test AI Predictions</button>
            <div id="ai-predictions-results"></div>
        </div>
        
        <div class="section">
            <h2>üí∞ Betting Lines Test</h2>
            <button class="btn" onclick="testBettingLines()">Test Betting Lines</button>
            <div id="betting-lines-results"></div>
        </div>
        
        <div class="section">
            <h2>ü§ñ ML Algorithms Test</h2>
            <button class="btn" onclick="testMLAlgorithms()">Test ML Algorithms</button>
            <div id="ml-algorithms-results"></div>
        </div>
        
        <div class="section">
            <h2>üìÖ College Football Scheduling Test</h2>
            <button class="btn" onclick="testCollegeScheduling()">Test College Scheduling</button>
            <div id="scheduling-results"></div>
        </div>
        
        <div class="section">
            <h2>üèüÔ∏è Venue & Conference Test</h2>
            <button class="btn" onclick="testVenueConference()">Test Venue & Conference Info</button>
            <div id="venue-conference-results"></div>
        </div>
        
        <div class="section">
            <h2>üìä Complete Enhancement Test</h2>
            <button class="btn" onclick="testCompleteEnhancements()">Test All Enhancements</button>
            <div id="complete-test-results"></div>
        </div>
    </div>

    <!-- NCAA Data Service -->
    <script src="ncaa-data-service.js"></script>
    
    <script>
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ NCAA AI Enhancements Test Page Loaded');
            checkServiceStatus();
        });
        
        // Check if NCAA Data Service is loaded
        function checkServiceStatus() {
            const statusDiv = document.getElementById('service-status');
            
            if (window.ncaaDataService) {
                statusDiv.innerHTML = '<div class="success">‚úÖ NCAA Data Service loaded successfully!</div>';
                console.log('‚úÖ NCAA Data Service available');
            } else {
                statusDiv.innerHTML = '<div class="error">‚ùå NCAA Data Service not loaded</div>';
                console.error('‚ùå NCAA Data Service not available');
            }
        }
        
        // Test AI Predictions
        async function testAIPredictions() {
            const resultsDiv = document.getElementById('ai-predictions-results');
            resultsDiv.innerHTML = '<div class="loading">Testing AI predictions...</div>';
            
            try {
                const games = await window.ncaaDataService.getTodaysGames();
                
                if (games.length === 0) {
                    resultsDiv.innerHTML = '<div class="error">No games available for AI prediction testing</div>';
                    return;
                }
                
                let html = `<div class="success">‚úÖ Testing AI predictions on ${games.length} games!</div>`;
                
                games.slice(0, 3).forEach(game => {
                    if (game.aiPrediction) {
                        const confidence = game.aiPrediction.confidence;
                        const confidenceClass = confidence >= 80 ? 'confidence-high' : 
                                              confidence >= 65 ? 'confidence-medium' : 'confidence-low';
                        
                        html += `
                            <div class="game-card">
                                <strong>${game.shortName}</strong>
                                <div class="ai-section">
                                    <h4>üß† AI Prediction</h4>
                                    <strong>Win Probabilities:</strong> ${game.teams.home.abbreviation} ${game.aiPrediction.homeWinProbability}% | ${game.teams.away.abbreviation} ${game.aiPrediction.awayWinProbability}%<br>
                                    <strong>Predicted Spread:</strong> ${game.aiPrediction.predictedSpread}<br>
                                    <strong>Predicted Score:</strong> ${game.teams.home.abbreviation} ${game.aiPrediction.predictedScore.home} - ${game.teams.away.abbreviation} ${game.aiPrediction.predictedScore.away}<br>
                                    <strong>Confidence:</strong> <span class="${confidenceClass}">${confidence}%</span><br>
                                    <strong>Recommendation:</strong> ${game.aiPrediction.recommendation}<br>
                                    <strong>Analysis:</strong> ${game.aiPrediction.analysis || 'N/A'}
                                </div>
                            </div>
                        `;
                    } else {
                        html += `
                            <div class="game-card">
                                <strong>${game.shortName}</strong>
                                <div class="error">‚ùå No AI prediction available</div>
                            </div>
                        `;
                    }
                });
                
                resultsDiv.innerHTML = html;
                console.log('üß† AI Predictions Test:', games);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('‚ùå AI predictions test error:', error);
            }
        }
        
        // Test Betting Lines
        async function testBettingLines() {
            const resultsDiv = document.getElementById('betting-lines-results');
            resultsDiv.innerHTML = '<div class="loading">Testing betting lines...</div>';
            
            try {
                const games = await window.ncaaDataService.getTodaysGames();
                
                if (games.length === 0) {
                    resultsDiv.innerHTML = '<div class="error">No games available for betting lines testing</div>';
                    return;
                }
                
                let html = `<div class="success">‚úÖ Testing betting lines on ${games.length} games!</div>`;
                
                games.slice(0, 3).forEach(game => {
                    if (game.bettingLines) {
                        html += `
                            <div class="game-card">
                                <strong>${game.shortName}</strong>
                                <div class="betting-section">
                                    <h4>üí∞ Betting Lines</h4>
                                    <strong>Spread:</strong> ${game.teams.home.abbreviation} ${game.bettingLines.spread.home} | ${game.teams.away.abbreviation} ${game.bettingLines.spread.away} (${game.bettingLines.spread.odds})<br>
                                    <strong>Moneyline:</strong> ${game.teams.home.abbreviation} ${game.bettingLines.moneyline.home} | ${game.teams.away.abbreviation} ${game.bettingLines.moneyline.away}<br>
                                    <strong>Total:</strong> ${game.bettingLines.total.over} / ${game.bettingLines.total.under} (${game.bettingLines.total.odds})<br>
                                    <strong>Sportsbooks:</strong> ${game.bettingLines.sportsbooks.join(', ')}<br>
                                    <strong>Source:</strong> ${game.bettingLines.source || 'N/A'}
                                </div>
                            </div>
                        `;
                    } else {
                        html += `
                            <div class="game-card">
                                <strong>${game.shortName}</strong>
                                <div class="error">‚ùå No betting lines available</div>
                            </div>
                        `;
                    }
                });
                
                resultsDiv.innerHTML = html;
                console.log('üí∞ Betting Lines Test:', games);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('‚ùå Betting lines test error:', error);
            }
        }
        
        // Test ML Algorithms
        async function testMLAlgorithms() {
            const resultsDiv = document.getElementById('ml-algorithms-results');
            resultsDiv.innerHTML = '<div class="loading">Testing ML algorithms...</div>';
            
            try {
                const games = await window.ncaaDataService.getTodaysGames();
                
                if (games.length === 0) {
                    resultsDiv.innerHTML = '<div class="error">No games available for ML algorithms testing</div>';
                    return;
                }
                
                let html = `<div class="success">‚úÖ Testing ML algorithms on ${games.length} games!</div>`;
                
                games.slice(0, 2).forEach(game => {
                    if (game.mlAlgorithms) {
                        const ml = game.mlAlgorithms;
                        html += `
                            <div class="game-card">
                                <strong>${game.shortName}</strong>
                                <div class="ml-section">
                                    <h4>ü§ñ ML Algorithm Predictions</h4>
                                    <strong>Neural Network:</strong> ${ml.neuralNetwork.prediction} (${ml.neuralNetwork.winProbability}% - ${ml.neuralNetwork.confidence}% conf) - ${ml.neuralNetwork.accuracy}<br>
                                    <strong>XGBoost:</strong> ${ml.xgboost.prediction} (${ml.xgboost.winProbability}% - ${ml.xgboost.confidence}% conf) - ${ml.xgboost.accuracy}<br>
                                    <strong>Ensemble:</strong> ${ml.ensemble.prediction} (${ml.ensemble.winProbability}% - ${ml.ensemble.confidence}% conf) - ${ml.ensemble.accuracy}<br>
                                    <strong>Consensus:</strong> ${ml.consensus.prediction} (${ml.consensus.winProbability}% - ${ml.consensus.confidence}% conf) - ${ml.consensus.edge} EDGE<br>
                                    <strong>Recommendation:</strong> ${ml.consensus.recommendation}<br>
                                    <strong>Model Agreement:</strong> ${ml.consensus.modelAgreement}%
                                </div>
                            </div>
                        `;
                    } else {
                        html += `
                            <div class="game-card">
                                <strong>${game.shortName}</strong>
                                <div class="error">‚ùå No ML algorithms available</div>
                            </div>
                        `;
                    }
                });
                
                resultsDiv.innerHTML = html;
                console.log('ü§ñ ML Algorithms Test:', games);
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('‚ùå ML algorithms test error:', error);
            }
        }
        
        // Test College Football Scheduling
        async function testCollegeScheduling() {
            const resultsDiv = document.getElementById('scheduling-results');
            resultsDiv.innerHTML = '<div class="loading">Testing college football scheduling...</div>';
            
            try {
                const currentWeek = window.ncaaDataService.getCurrentCollegeWeek();
                const today = new Date();
                const dayOfWeek = today.getDay();
                const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                
                let html = `<div class="success">‚úÖ College Football Scheduling Test Results</div>`;
                html += `
                    <div class="game-card">
                        <h4>üìÖ Season Timing (August-January)</h4>
                        <strong>Current Week:</strong> ${currentWeek}<br>
                        <strong>Today:</strong> ${dayNames[dayOfWeek]} (${today.toLocaleDateString()})<br>
                        <strong>Season Status:</strong> ${getSeasonStatus(today)}<br>
                    </div>
                `;
                
                // Test different day scheduling
                const games = await window.ncaaDataService.getTodaysGames();
                const gamesByDay = {
                    'Saturday': games.filter(g => new Date(g.date).getDay() === 6).length,
                    'Friday': games.filter(g => new Date(g.date).getDay() === 5).length,
                    'Thursday': games.filter(g => new Date(g.date).getDay() === 4).length,
                    'Other': games.filter(g => ![4,5,6].includes(new Date(g.date).getDay())).length
                };
                
                html += `
                    <div class="game-card">
                        <h4>üèà Game Distribution by Day</h4>
                        <strong>Saturday Games:</strong> ${gamesByDay.Saturday} (Primary college football day)<br>
                        <strong>Friday Games:</strong> ${gamesByDay.Friday}<br>
                        <strong>Thursday Games:</strong> ${gamesByDay.Thursday}<br>
                        <strong>Other Days:</strong> ${gamesByDay.Other}<br>
                        <strong>Total Games:</strong> ${games.length}
                    </div>
                `;
                
                resultsDiv.innerHTML = html;
                console.log('üìÖ College Scheduling Test:', { currentWeek, gamesByDay });
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('‚ùå College scheduling test error:', error);
            }
        }
        
        // Test Venue & Conference Information
        async function testVenueConference() {
            const resultsDiv = document.getElementById('venue-conference-results');
            resultsDiv.innerHTML = '<div class="loading">Testing venue and conference information...</div>';
            
            try {
                const games = await window.ncaaDataService.getTodaysGames();
                
                if (games.length === 0) {
                    resultsDiv.innerHTML = '<div class="error">No games available for venue/conference testing</div>';
                    return;
                }
                
                let html = `<div class="success">‚úÖ Testing venue and conference info on ${games.length} games!</div>`;
                
                // Collect venue and conference data
                const venues = new Set();
                const conferences = new Set();
                
                games.slice(0, 5).forEach(game => {
                    if (game.venue) venues.add(game.venue);
                    
                    // Extract conference info from team strength calculation
                    const homeTeam = game.teams.home.abbreviation;
                    const awayTeam = game.teams.away.abbreviation;
                    
                    html += `
                        <div class="game-card">
                            <strong>${game.shortName}</strong><br>
                            <strong>Venue:</strong> ${game.venue || 'TBD'}<br>
                            <strong>Home Team:</strong> ${game.teams.home.name} (${homeTeam})<br>
                            <strong>Away Team:</strong> ${game.teams.away.name} (${awayTeam})<br>
                            <strong>Week:</strong> ${game.week || 'N/A'}<br>
                            <strong>Season:</strong> ${game.season || new Date().getFullYear()}
                        </div>
                    `;
                });
                
                html += `
                    <div class="game-card">
                        <h4>üèüÔ∏è Venue Summary</h4>
                        <strong>Unique Venues:</strong> ${venues.size}<br>
                        <strong>Sample Venues:</strong> ${Array.from(venues).slice(0, 3).join(', ')}${venues.size > 3 ? '...' : ''}
                    </div>
                `;
                
                resultsDiv.innerHTML = html;
                console.log('üèüÔ∏è Venue & Conference Test:', { venues: Array.from(venues), games });
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('‚ùå Venue/conference test error:', error);
            }
        }
        
        // Test Complete Enhancements
        async function testCompleteEnhancements() {
            const resultsDiv = document.getElementById('complete-test-results');
            resultsDiv.innerHTML = '<div class="loading">Running complete enhancement test...</div>';
            
            try {
                const games = await window.ncaaDataService.getTodaysGames();
                
                if (games.length === 0) {
                    resultsDiv.innerHTML = '<div class="error">No games available for complete testing</div>';
                    return;
                }
                
                // Test all enhancements on first game
                const testGame = games[0];
                
                let html = `<div class="success">‚úÖ Complete Enhancement Test Results</div>`;
                
                // Check all required enhancements
                const enhancements = {
                    'AI Predictions': !!testGame.aiPrediction,
                    'Betting Lines': !!testGame.bettingLines,
                    'ML Algorithms': !!testGame.mlAlgorithms,
                    'Team Strength Calculation': !!testGame.aiPrediction?.confidence,
                    'College Scheduling': !!testGame.week,
                    'Venue Information': !!testGame.venue,
                    'Season Timing': !!window.ncaaDataService.getCurrentCollegeWeek()
                };
                
                html += `
                    <div class="game-card">
                        <h4>üîç Enhancement Checklist for: ${testGame.shortName}</h4>
                `;
                
                Object.entries(enhancements).forEach(([feature, available]) => {
                    const status = available ? '‚úÖ' : '‚ùå';
                    const statusClass = available ? 'success' : 'error';
                    html += `<div class="${statusClass}">${status} ${feature}</div>`;
                });
                
                html += `</div>`;
                
                // Summary statistics
                const totalFeatures = Object.keys(enhancements).length;
                const workingFeatures = Object.values(enhancements).filter(Boolean).length;
                const completionRate = Math.round((workingFeatures / totalFeatures) * 100);
                
                html += `
                    <div class="game-card">
                        <h4>üìä Enhancement Summary</h4>
                        <strong>Features Working:</strong> ${workingFeatures}/${totalFeatures}<br>
                        <strong>Completion Rate:</strong> <span class="${completionRate >= 80 ? 'confidence-high' : completionRate >= 60 ? 'confidence-medium' : 'confidence-low'}">${completionRate}%</span><br>
                        <strong>Total Games Tested:</strong> ${games.length}<br>
                        <strong>Status:</strong> ${completionRate >= 80 ? '‚úÖ All enhancements working' : completionRate >= 60 ? '‚ö†Ô∏è Most enhancements working' : '‚ùå Some enhancements missing'}
                    </div>
                `;
                
                resultsDiv.innerHTML = html;
                console.log('üîç Complete Enhancement Test:', { enhancements, completionRate, testGame });
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
                console.error('‚ùå Complete enhancement test error:', error);
            }
        }
        
        // Helper function to get season status
        function getSeasonStatus(date) {
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            if (month >= 8 && month <= 12) {
                return 'Regular Season';
            } else if (month === 1) {
                return 'Bowl Season / Playoffs';
            } else {
                return 'Off Season';
            }
        }
    </script>
</body>
</html>