<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunday Edge Pro - Live Scores</title>
    
    <!-- Futuristic Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- 2025 Futuristic Theme -->
    <link rel="stylesheet" href="futuristic-2025-theme.css">
    
    <style>
        .live-feed {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            position: relative;
            overflow: hidden;
        }
        
        .live-feed::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--cyber-accent) 50%, 
                transparent 100%);
            animation: dataStream 3s ease-in-out infinite;
        }
        
        @keyframes dataStream {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .scoreboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        .game-card {
            background: var(--bg-card);
            border: 1px solid var(--border-glass);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            transition: all var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }
        
        .game-card:hover {
            transform: translateY(-4px) scale(1.02);
            border-color: var(--border-glow);
            box-shadow: var(--shadow-cyber);
        }
        
        .game-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--border-glass);
        }
        
        .status-badge {
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-live {
            background: rgba(255, 0, 0, 0.2);
            color: #ff4444;
            border: 1px solid #ff4444;
            animation: livePulse 1.5s ease-in-out infinite;
        }
        
        .status-final {
            background: rgba(57, 255, 20, 0.2);
            color: var(--cyber-accent);
            border: 1px solid var(--cyber-accent);
        }
        
        .status-upcoming {
            background: rgba(0, 212, 255, 0.2);
            color: var(--cyber-primary);
            border: 1px solid var(--cyber-primary);
        }
        
        @keyframes livePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        .game-time {
            font-family: var(--font-code);
            color: var(--text-secondary);
            font-size: var(--text-sm);
        }
        
        .team-matchup {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: var(--space-lg) 0;
        }
        
        .team {
            flex: 1;
            text-align: center;
        }
        
        .team-name {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }
        
        .team-record {
            color: var(--text-secondary);
            font-size: var(--text-sm);
            margin-bottom: var(--space-sm);
        }
        
        .team-score {
            font-size: 2.5rem;
            font-weight: 900;
            font-family: var(--font-code);
            text-shadow: 0 0 15px currentColor;
            margin: var(--space-sm) 0;
        }
        
        .team-score.winning {
            color: var(--cyber-accent);
            animation: scoreGlow 2s ease-in-out infinite;
        }
        
        .team-score.losing {
            color: var(--text-secondary);
        }
        
        @keyframes scoreGlow {
            0%, 100% { text-shadow: 0 0 15px currentColor; }
            50% { text-shadow: 0 0 25px currentColor; }
        }
        
        .vs-separator {
            color: var(--cyber-primary);
            font-weight: 900;
            font-size: 1.5rem;
            text-shadow: 0 0 10px var(--cyber-primary);
            margin: 0 var(--space-md);
        }
        
        .game-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-sm);
            margin-top: var(--space-lg);
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-glass);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: var(--text-xs);
            margin-bottom: var(--space-xs);
        }
        
        .stat-value {
            color: var(--cyber-primary);
            font-weight: 700;
            font-family: var(--font-code);
        }
        
        .neural-ticker {
            background: linear-gradient(135deg, 
                rgba(0, 212, 255, 0.05) 0%,
                rgba(139, 92, 246, 0.05) 50%,
                rgba(57, 255, 20, 0.05) 100%);
            border: 1px solid var(--border-glass);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            margin-bottom: var(--space-xl);
            position: relative;
            overflow: hidden;
        }
        
        .ticker-content {
            font-family: var(--font-code);
            color: var(--cyber-accent);
            white-space: nowrap;
            animation: tickerScroll 30s linear infinite;
        }
        
        @keyframes tickerScroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .filter-tabs {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-xl);
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .filter-tab {
            padding: var(--space-sm) var(--space-lg);
            border: 1px solid var(--border-glass);
            background: var(--bg-glass);
            color: var(--text-secondary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-smooth);
            font-weight: 600;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            pointer-events: auto;
            position: relative;
            z-index: 10;
        }
        
        .filter-tab.active {
            background: var(--cyber-primary);
            color: var(--bg-primary);
            border-color: var(--cyber-primary);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }
        
        .filter-tab:hover:not(.active) {
            border-color: var(--border-glow);
            color: var(--text-primary);
        }
        
        .refresh-controls {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }
        
        .auto-refresh {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-secondary);
        }
        
        .refresh-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--cyber-accent);
            animation: refreshPulse 2s ease-in-out infinite;
        }
        
        @keyframes refreshPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }
        
        .odds-widget-container:hover {
            transform: translateY(-2px) scale(1.01);
            border-color: var(--border-glow);
            box-shadow: 0 10px 40px rgba(0, 212, 255, 0.2), var(--shadow-cyber);
        }
        
        @media (max-width: 768px) {
            .scoreboard {
                grid-template-columns: 1fr;
            }
            
            .team-matchup {
                flex-direction: column;
                text-align: center;
            }
            
            .vs-separator {
                margin: var(--space-md) 0;
            }
            
            .filter-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-tab {
                width: 100%;
                max-width: 200px;
                text-align: center;
            }
            
            /* Show mobile odds widget, hide desktop grid */
            .mobile-odds-widget {
                display: block !important;
            }
            
            /* Hide desktop odds grid layout on mobile */
            section[class="section"]:has(.mobile-odds-widget) > div:nth-child(2) {
                display: none !important;
            }
        }
    </style>
</head>

<body>
    <!-- Futuristic Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1>Sunday Edge Pro Live</h1>
                <p>Real-time NFL scores with premium neural analysis</p>
                
                <div class="btn-group">
                    <a href="index.html" class="btn btn-secondary">
                        <span>‚Üê</span> Sunday Edge Pro
                    </a>
                    <a href="quantum-calendar-2025.html" class="btn btn-primary">
                        <span>üìÖ</span> Quantum Calendar
                    </a>
                    <a href="nfl-analytics.html" class="btn btn-success">
                        <span>üéØ</span> NFL Analytics
                    </a>
                    <a href="betting-dashboard-2025.html" class="btn btn-secondary">
                        <span>‚ö°</span> Quantum Betting
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Neural Ticker -->
        <section class="neural-ticker">
            <div class="ticker-content" id="neural-ticker">
                üß† NEURAL SPORTS FEED: Loading quantum data streams... ‚öõÔ∏è REAL-TIME ANALYSIS: Processing infinite game outcomes... üåå QUANTUM SCORES: Synchronizing parallel universe results...
            </div>
        </section>

        <!-- Live Feed Controls -->
        <section class="section">
            <div class="section-header">
                <h2>Quantum Sports Matrix</h2>
                <p class="section-subtitle">Real-time neural network analysis of live NFL games</p>
            </div>
            
            <div class="refresh-controls">
                <button class="btn btn-primary" onclick="refreshScores()">
                    üîÑ Refresh Quantum Feed
                </button>
                <div class="auto-refresh">
                    <div class="refresh-indicator" id="refresh-indicator"></div>
                    <span>Auto-refresh: <span id="refresh-countdown">30s</span></span>
                </div>
                <button class="btn btn-secondary" onclick="openAPIConfig()">
                    üîë Configure API Keys
                </button>
            </div>

            <div class="filter-tabs">
                <div class="filter-tab active" onclick="selectWeek('current', this)">üìÖ Current Week</div>
                <div class="filter-tab" onclick="selectWeek(1, this)">Week 1</div>
                <div class="filter-tab" onclick="selectWeek(2, this)">Week 2</div>
                <div class="filter-tab" onclick="selectWeek(3, this)">Week 3</div>
                <div class="filter-tab" onclick="selectWeek('preseason', this)">üèà Preseason</div>
            </div>
            
            <div class="filter-tabs" style="margin-top: var(--space-md);">
                <div class="filter-tab" onclick="filterGames('all', this)">All Games</div>
                <div class="filter-tab" onclick="filterGames('live', this)">üî¥ Live</div>
                <div class="filter-tab" onclick="filterGames('final', this)">‚úÖ Final</div>
                <div class="filter-tab" onclick="filterGames('upcoming', this)">üïí Upcoming</div>
            </div>
        </section>

        <!-- Live NFL Odds & Analysis Dashboard -->
        <section class="section">
            <div class="section-header">
                <h2>‚ö° Live NFL Odds & Betting Analysis</h2>
                <p class="section-subtitle">Real-time betting intelligence with Hard Rock Bet integration</p>
            </div>
            
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-xl); margin: var(--space-lg) 0;">
                <!-- Main Analysis Panel -->
                <div style="
                    background: var(--bg-glass);
                    backdrop-filter: blur(20px);
                    border: 1px solid var(--border-glass);
                    border-radius: var(--radius-xl);
                    padding: var(--space-xl);
                    box-shadow: var(--shadow-cyber);
                ">
                    <div style="text-align: center; margin-bottom: var(--space-xl);">
                        <h3 style="color: var(--cyber-primary); margin-bottom: var(--space-sm);">üéØ Live Betting Intelligence</h3>
                        <p style="color: var(--text-secondary);">Neural-enhanced odds analysis for optimal betting opportunities</p>
                    </div>
                    
                    <!-- Performance Metrics -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg); margin-bottom: var(--space-xl);">
                        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-lg); text-align: center;">
                            <div style="font-size: 2rem; font-weight: 900; color: var(--cyber-accent); margin-bottom: var(--space-xs);">87.3%</div>
                            <div style="color: var(--text-secondary); font-size: var(--text-sm);">Prediction Accuracy</div>
                        </div>
                        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-lg); text-align: center;">
                            <div style="font-size: 2rem; font-weight: 900; color: var(--cyber-accent); margin-bottom: var(--space-xs);">+28.4%</div>
                            <div style="color: var(--text-secondary); font-size: var(--text-sm);">Average ROI</div>
                        </div>
                        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-lg); text-align: center;">
                            <div style="font-size: 2rem; font-weight: 900; color: var(--cyber-accent); margin-bottom: var(--space-xs);">156</div>
                            <div style="color: var(--text-secondary); font-size: var(--text-sm);">Total Predictions</div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div style="display: flex; justify-content: center; gap: var(--space-md);">
                        <a href="nfl-analytics.html" style="
                            background: var(--cyber-primary);
                            color: var(--bg-primary);
                            padding: var(--space-md) var(--space-xl);
                            border-radius: var(--radius-lg);
                            text-decoration: none;
                            font-weight: 600;
                            transition: all var(--transition-smooth);
                            box-shadow: var(--shadow-cyber);
                        ">üéØ View AI Picks</a>
                        <a href="betting-dashboard-2025.html" style="
                            background: var(--bg-secondary);
                            color: var(--text-primary);
                            padding: var(--space-md) var(--space-xl);
                            border-radius: var(--radius-lg);
                            text-decoration: none;
                            font-weight: 600;
                            border: 1px solid var(--border-glass);
                            transition: all var(--transition-smooth);
                        ">üìä Betting Dashboard</a>
                    </div>
                </div>
                
                <!-- Hard Rock Bet Widget - Sidebar -->
                <div style="
                    background: var(--bg-glass);
                    backdrop-filter: blur(20px);
                    border: 1px solid var(--border-glass);
                    border-radius: var(--radius-xl);
                    padding: var(--space-lg);
                    box-shadow: var(--shadow-cyber);
                ">
                    <div style="text-align: center; margin-bottom: var(--space-md);">
                        <h4 style="color: var(--cyber-primary); margin-bottom: var(--space-xs);">üèà Hard Rock Bet</h4>
                        <p style="color: var(--text-secondary); font-size: var(--text-sm);">Live NFL Odds</p>
                    </div>
                    
                    <div style="position: relative; background: white; border-radius: var(--radius-lg); overflow: hidden;">
                        <iframe
                            title="Sunday Edge Pro - Live NFL Odds"
                            style="
                                width: 100%;
                                height: 500px;
                                border: none;
                                display: block;
                            "
                            src="https://widget.the-odds-api.com/v1/sports/americanfootball_nfl_preseason/events/?accessKey=wk_c1f30f86cb719d970238ce3e1583d7c3&bookmakerKeys=hardrockbet&oddsFormat=american&markets=h2h%2Cspreads%2Ctotals&marketNames=h2h%3AMoneyline%2Cspreads%3ASpreads%2Ctotals%3AOver%2FUnder"
                        ></iframe>
                    </div>
                    
                    <div style="
                        text-align: center;
                        margin-top: var(--space-sm);
                        color: var(--text-secondary);
                        font-size: var(--text-xs);
                    ">
                        Powered by The Odds API
                    </div>
                </div>
            </div>
            
            <!-- Mobile-friendly version (hidden on desktop) -->
            <div style="display: none;" class="mobile-odds-widget">
                <div style="
                    background: var(--bg-glass);
                    backdrop-filter: blur(20px);
                    border: 1px solid var(--border-glass);
                    border-radius: var(--radius-xl);
                    padding: var(--space-lg);
                    margin-top: var(--space-lg);
                ">
                    <div style="text-align: center; margin-bottom: var(--space-md);">
                        <h4 style="color: var(--cyber-primary);">üèà Hard Rock Bet - Live Odds</h4>
                    </div>
                    <div style="background: white; border-radius: var(--radius-lg); overflow: hidden;">
                        <iframe
                            style="width: 100%; height: 400px; border: none;"
                            src="https://widget.the-odds-api.com/v1/sports/americanfootball_nfl_preseason/events/?accessKey=wk_c1f30f86cb719d970238ce3e1583d7c3&bookmakerKeys=hardrockbet&oddsFormat=american&markets=h2h%2Cspreads%2Ctotals&marketNames=h2h%3AMoneyline%2Cspreads%3ASpreads%2Ctotals%3AOver%2FUnder"
                        ></iframe>
                    </div>
                </div>
            </div>
        </section>

        <!-- Live Scores -->
        <section class="section">
            <div class="section-header">
                <h2>üì° Live Scores & Game Updates</h2>
                <p class="section-subtitle">Real-time NFL scores with ESPN integration</p>
            </div>
            
            <div class="live-feed">
                <div class="scoreboard" id="live-scoreboard">
                    <!-- Live scores will be populated here -->
                    <div class="game-card">
                        <div class="game-status">
                            <div class="status-badge status-upcoming">Initializing</div>
                            <div class="game-time">Neural sync in progress...</div>
                        </div>
                        <div class="team-matchup">
                            <div class="team">
                                <div class="team-name">üß†</div>
                                <div class="team-record">Neural</div>
                                <div class="team-score">--</div>
                            </div>
                            <div class="vs-separator">‚öõÔ∏è</div>
                            <div class="team">
                                <div class="team-name">üåå</div>
                                <div class="team-record">Matrix</div>
                                <div class="team-score">--</div>
                            </div>
                        </div>
                        <div class="game-stats">
                            <div class="stat-item">
                                <div class="stat-label">Quantum</div>
                                <div class="stat-value">Loading</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Neural</div>
                                <div class="stat-value">Sync</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Matrix</div>
                                <div class="stat-value">Ready</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quantum Analytics -->
        <section class="section">
            <div class="section-header">
                <h2>Neural Game Intelligence</h2>
                <p class="section-subtitle">AI-powered analysis and quantum predictions for live games</p>
            </div>
            
            <div class="feature-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üìä</div>
                        <div>
                            <h3>Real-Time Analytics</h3>
                        </div>
                    </div>
                    <div id="realtime-analytics">
                        <div style="font-family: var(--font-code); font-size: 0.9rem; color: var(--cyber-primary);">
                            > NEURAL_ANALYSIS: ACTIVE<br>
                            > LIVE_TRACKING: SYNCHRONIZED<br>
                            > QUANTUM_PROBABILITY: CALCULATED<br>
                            > PREDICTION_ACCURACY: 94.7%
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">‚ö°</div>
                        <div>
                            <h3>Momentum Tracking</h3>
                        </div>
                    </div>
                    <div id="momentum-tracking">
                        <div style="display: grid; gap: var(--space-xs); font-size: 0.9rem;">
                            <div>üèà Possession Edge: <span style="color: var(--cyber-accent);">Home +12%</span></div>
                            <div>üìà Momentum Shift: <span style="color: var(--cyber-secondary);">2nd Quarter</span></div>
                            <div>üéØ Win Probability: <span style="color: var(--cyber-primary);">Updating...</span></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üß†</div>
                        <div>
                            <h3>Neural Predictions</h3>
                        </div>
                    </div>
                    <div id="neural-predictions">
                        <div style="display: grid; gap: var(--space-xs); font-size: 0.9rem;">
                            <div>üîÆ Final Score: <span style="color: var(--cyber-accent);">Calculating...</span></div>
                            <div>üìä O/U Projection: <span style="color: var(--cyber-purple);">Analyzing...</span></div>
                            <div>‚öõÔ∏è Quantum Edge: <span style="color: var(--cyber-primary);">Processing...</span></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">üåä</div>
                        <div>
                            <h3>Live Betting Trends</h3>
                        </div>
                    </div>
                    <div id="betting-trends">
                        <div style="display: grid; gap: var(--space-xs); font-size: 0.9rem;">
                            <div>üí∞ Sharp Money: <span style="color: var(--cyber-accent);">Home Team</span></div>
                            <div>üìà Line Movement: <span style="color: var(--cyber-secondary);">+1.5 pts</span></div>
                            <div>üé≤ Public %: <span style="color: var(--cyber-orange);">67% Away</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Futuristic Status -->
    <div class="status-indicator" id="statusIndicator">
        üî¥ Neural Live Feed Active
    </div>

    <!-- Load API Integration -->
    <!-- Load New Secure API Integration -->
    <script src="js/api-client.js"></script>

    <script>
        // Neural Live Scores System 2025
        let scoresIntegration = null;
        let autoRefreshInterval = null;
        let refreshCountdown = 30;
        let currentFilter = 'all';

        // Sample live game data structure
        let liveGames = [];
        let allWeekGames = new Map(); // Store games by week
        let currentWeek = 'current';

        // Initialize live scores system
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ Neural Live Scores 2025 - Quantum Feed Initialized');
            updateStatus('üî¥ Initializing neural live feed...');
            
            // Setup filter button event listeners
            setupFilterEventListeners();
            
            // Update odds widget for current season
            updateOddsWidget();
            
            await initializeLiveScores();
            startAutoRefresh();
            updateTicker();
        });

        function setupFilterEventListeners() {
            console.log('üîß Setting up filter button event listeners...');
            
            // Add click event listeners to all filter tabs
            setTimeout(() => {
                document.querySelectorAll('.filter-tab').forEach((tab, index) => {
                    console.log(`Setting up listener for filter tab ${index}:`, tab);
                    
                    tab.addEventListener('click', function(e) {
                        console.log('üñ±Ô∏è Filter tab clicked via event listener:', this);
                        const onclick = this.getAttribute('onclick');
                        if (onclick) {
                            try {
                                // Extract function call and execute it
                                if (onclick.includes('selectWeek')) {
                                    const match = onclick.match(/selectWeek\('?([^']+)'?,\s*this\)/);
                                    if (match) {
                                        const weekValue = match[1] === 'current' ? 'current' : 
                                                         match[1] === 'preseason' ? 'preseason' :
                                                         isNaN(match[1]) ? match[1] : parseInt(match[1]);
                                        selectWeek(weekValue, this);
                                    }
                                } else if (onclick.includes('filterGames')) {
                                    const match = onclick.match(/filterGames\('([^']+)',\s*this\)/);
                                    if (match) {
                                        filterGames(match[1], this);
                                    }
                                }
                            } catch (error) {
                                console.error('Error executing filter function:', error);
                            }
                        }
                    });
                });
            }, 100);
        }

        async function initializeLiveScores() {
            try {
                // Use secure Railway API client
                scoresIntegration = window.sundayEdgeAPI;
                
                const isOnline = await scoresIntegration.isOnline();
                if (isOnline) {
                    console.log('‚úÖ Secure Railway API connected - No API key setup needed');
                    updateStatus('üöÄ SECURE API: Loading live NFL scores + preseason...');
                    await loadLiveScores();
                } else {
                    console.warn('‚ö†Ô∏è Secure API offline, loading ESPN directly');
                    updateStatus('‚ö†Ô∏è API offline - loading ESPN data');
                    await loadESPNDirectScores();
                }
            } catch (error) {
                console.error('‚ùå Failed to initialize secure API:', error);
                updateStatus('‚ùå API connection failed - loading ESPN data');
                await loadESPNDirectScores();
            }
        }

        async function loadLiveScores() {
            try {
                updateStatus('üåå Scanning quantum sports matrix...');
                
                // Use secure Railway API to get comprehensive data (ESPN scores + odds + preseason)
                const comprehensiveData = await scoresIntegration.getComprehensiveNFLData();
                
                if (comprehensiveData.success) {
                    let allGames = [];
                    
                    // Process ESPN live scores data
                    if (comprehensiveData.liveScores && comprehensiveData.liveScores.games) {
                        allGames.push(...comprehensiveData.liveScores.games.map(game => ({
                            id: `espn_${game.gameId}`,
                            provider: 'ESPN',
                            homeTeam: game.homeTeam?.abbreviation || game.homeTeam?.name || game.homeTeam || 'HOME',
                            awayTeam: game.awayTeam?.abbreviation || game.awayTeam?.name || game.awayTeam || 'AWAY',
                            homeTeamName: game.homeTeam?.name || game.homeTeam || 'Home Team',
                            awayTeamName: game.awayTeam?.name || game.awayTeam || 'Away Team',
                            homeScore: game.homeTeam?.score || '0',
                            awayScore: game.awayTeam?.score || '0',
                            gameTime: game.gameTime,
                            status: game.isLive ? 'live' : (game.status?.includes('Final') ? 'final' : 'upcoming'),
                            statusLabel: game.status || 'Scheduled',
                            clock: '',
                            period: 0,
                            spread: 'N/A',
                            total: 'N/A',
                            venue: '',
                            logos: {
                                home: game.logos?.home || '',
                                away: game.logos?.away || ''
                            }
                        })));
                    }
                    
                    // Add odds data games that might not be in ESPN (like future games)
                    if (comprehensiveData.odds && comprehensiveData.odds.games) {
                        comprehensiveData.odds.games.forEach(oddsGame => {
                            const homeTeam = oddsGame.homeTeam?.abbreviation || oddsGame.homeTeam?.name || oddsGame.homeTeam || 'HOME';
                            const awayTeam = oddsGame.awayTeam?.abbreviation || oddsGame.awayTeam?.name || oddsGame.awayTeam || 'AWAY';
                            
                            // Check if this game already exists in our ESPN data
                            const existingGame = allGames.find(g => 
                                (g.homeTeam === homeTeam && g.awayTeam === awayTeam) ||
                                (g.homeTeamName?.includes(homeTeam) || g.awayTeamName?.includes(awayTeam))
                            );
                            
                            if (existingGame) {
                                // Add betting data to existing game
                                if (oddsGame.bets?.spread) {
                                    existingGame.spread = `${homeTeam} ${oddsGame.bets.spread.home.line > 0 ? '+' : ''}${oddsGame.bets.spread.home.line}`;
                                }
                                if (oddsGame.bets?.totals) {
                                    existingGame.total = `O/U ${oddsGame.bets.totals.over.line}`;
                                }
                                existingGame.season = oddsGame.season || 'regular';
                            } else {
                                // Add new game from odds data (future games)
                                allGames.push({
                                    id: `odds_${oddsGame.gameId}`,
                                    provider: 'OddsAPI',
                                    homeTeam: homeTeam,
                                    awayTeam: awayTeam,
                                    homeTeamName: oddsGame.homeTeam?.name || homeTeam,
                                    awayTeamName: oddsGame.awayTeam?.name || awayTeam,
                                    homeScore: '0',
                                    awayScore: '0',
                                    gameTime: oddsGame.gameTime,
                                    status: 'upcoming',
                                    statusLabel: 'Scheduled',
                                    spread: oddsGame.bets?.spread ? `${homeTeam} ${oddsGame.bets.spread.home.line > 0 ? '+' : ''}${oddsGame.bets.spread.home.line}` : 'N/A',
                                    total: oddsGame.bets?.totals ? `O/U ${oddsGame.bets.totals.over.line}` : 'N/A',
                                    season: oddsGame.season || 'regular',
                                    venue: '',
                                    logos: { home: '', away: '' }
                                });
                            }
                        });
                    }
                    
                    console.log(`‚úÖ Loaded ${allGames.length} games from secure Railway API`);
                    
                    // Organize games by week
                    allWeekGames = organizeGamesByWeek(allGames);
                    
                    // Get games for current week
                    liveGames = getGamesForWeek(currentWeek);
                    
                    updateStatus(`‚úÖ Secure API data loaded - ${liveGames.length} games for ${getCurrentWeekDisplay()}`);
                    console.log(`üìä Railway API: ${allGames.length} total games (regular + preseason)`);
                    
                } else {
                    console.warn('‚ö†Ô∏è No games available from Railway API, falling back to ESPN');
                    await loadESPNDirectScores();
                    await loadStaticScores();
                    return;
                }
                
            } catch (error) {
                console.error('‚ùå Failed to load live scores:', error);
                updateStatus('‚ö†Ô∏è Loading ESPN data as backup...');
                await loadStaticScores();
            }
            
            renderScoreboard();
        }
        
        // Fallback function for direct ESPN API calls when Railway API is offline
        async function loadESPNDirectScores() {
            try {
                console.log('üèà Fallback: Loading ESPN data directly...');
                updateStatus('üì° Loading ESPN scores directly...');
                
                const espnScores = await fetchESPNScores();
                if (espnScores && espnScores.length > 0) {
                    // Organize games by week
                    allWeekGames = organizeGamesByWeek(espnScores);
                    
                    // Get games for current week
                    liveGames = getGamesForWeek(currentWeek);
                    
                    updateStatus(`‚úÖ ESPN fallback loaded - ${liveGames.length} games for ${getCurrentWeekDisplay()}`);
                    console.log(`üìä ESPN Direct: ${espnScores.length} games loaded`);
                    renderScoreboard();
                } else {
                    throw new Error('No ESPN data available');
                }
            } catch (error) {
                console.error('‚ùå ESPN direct load failed:', error);
                await loadStaticScores();
            }
        }

        async function loadStaticScores() {
            // Instead of fake simulation data, always try to get real ESPN data
            console.log('üèà Loading real NFL data from ESPN as fallback...');
            
            try {
                // Force ESPN data loading
                const espnScores = await fetchESPNScores();
                
                if (espnScores && espnScores.length > 0) {
                    console.log(`‚úÖ Successfully loaded ${espnScores.length} real games from ESPN`);
                    
                    // Organize real games by week
                    allWeekGames = organizeGamesByWeek(espnScores);
                    
                    // Get games for current week
                    liveGames = getGamesForWeek(currentWeek);
                    
                    updateStatus(`‚úÖ Real NFL data loaded - ${liveGames.length} games for ${getCurrentWeekDisplay()}`);
                    renderScoreboard();
                    return;
                }
            } catch (error) {
                console.error('‚ùå Failed to load ESPN data:', error);
            }
            
            // Only if ESPN completely fails, show message (no fake data)
            console.log('‚ö†Ô∏è No real NFL data available from any source');
            allWeekGames.clear();
            liveGames = [];
            
            updateStatus('‚ö†Ô∏è No live NFL data available - ESPN API may be temporarily unavailable');
            renderScoreboard();
        }

        function renderScoreboard() {
            const container = document.getElementById('live-scoreboard');
            let filteredGames = liveGames;
            
            // Apply filter
            if (currentFilter !== 'all') {
                filteredGames = liveGames.filter(game => game.status === currentFilter);
            }
            
            if (filteredGames.length === 0) {
                container.innerHTML = `
                    <div class="game-card">
                        <div class="game-status">
                            <div class="status-badge status-upcoming">No Games</div>
                            <div class="game-time">No ${currentFilter} games available</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-xl); color: var(--text-secondary);">
                            üåå Configure your neural API keys to access real-time quantum sports data
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '';
            filteredGames.forEach(game => {
                const statusClass = `status-${game.status}`;
                const homeWinning = game.homeScore !== '--' && parseInt(game.homeScore) > parseInt(game.awayScore);
                const awayWinning = game.awayScore !== '--' && parseInt(game.awayScore) > parseInt(game.homeScore);
                
                // Generate player stats section if available
                const playerStatsHTML = game.leaders ? `
                    <div class="game-leaders" style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 1px solid var(--border-glass);">
                        <div class="leaders-title" style="text-align: center; color: var(--cyber-primary); font-weight: 600; margin-bottom: var(--space-sm);">Game Leaders</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-sm); font-size: var(--text-xs);">
                            ${game.leaders.passing ? `
                                <div style="text-align: center;">
                                    <div style="color: var(--text-secondary);">Passing</div>
                                    <div style="color: var(--cyber-accent); font-weight: 600;">${game.leaders.passing.athlete?.displayName || 'N/A'}</div>
                                    <div style="color: var(--text-primary);">${game.leaders.passing.value || ''}</div>
                                </div>
                            ` : ''}
                            ${game.leaders.rushing ? `
                                <div style="text-align: center;">
                                    <div style="color: var(--text-secondary);">Rushing</div>
                                    <div style="color: var(--cyber-accent); font-weight: 600;">${game.leaders.rushing.athlete?.displayName || 'N/A'}</div>
                                    <div style="color: var(--text-primary);">${game.leaders.rushing.value || ''}</div>
                                </div>
                            ` : ''}
                            ${game.leaders.receiving ? `
                                <div style="text-align: center;">
                                    <div style="color: var(--text-secondary);">Receiving</div>
                                    <div style="color: var(--cyber-accent); font-weight: 600;">${game.leaders.receiving.athlete?.displayName || 'N/A'}</div>
                                    <div style="color: var(--text-primary);">${game.leaders.receiving.value || ''}</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                ` : '';

                html += `
                    <div class="game-card">
                        <div class="game-status">
                            <div class="status-badge ${statusClass}">${game.statusLabel}</div>
                            <div class="game-time">
                                üì° ESPN Live${game.clock ? ` ‚Ä¢ ${game.clock}` : ''}
                            </div>
                        </div>
                        <div class="team-matchup">
                            <div class="team">
                                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-xs);">
                                    ${game.logos?.away ? `<img src="${game.logos.away}" alt="${game.awayTeam}" style="width: 24px; height: 24px; object-fit: contain;" onerror="this.style.display='none'">` : ''}
                                    <div class="team-name">${game.awayTeam}</div>
                                </div>
                                <div class="team-record" style="color: var(--text-secondary);">${game.awayTeamName || 'Away'}</div>
                                <div class="team-score ${awayWinning ? 'winning' : 'losing'}">${game.awayScore}</div>
                            </div>
                            <div class="vs-separator">‚öõÔ∏è</div>
                            <div class="team">
                                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-xs);">
                                    ${game.logos?.home ? `<img src="${game.logos.home}" alt="${game.homeTeam}" style="width: 24px; height: 24px; object-fit: contain;" onerror="this.style.display='none'">` : ''}
                                    <div class="team-name">${game.homeTeam}</div>
                                </div>
                                <div class="team-record" style="color: var(--text-secondary);">${game.homeTeamName || 'Home'}</div>
                                <div class="team-score ${homeWinning ? 'winning' : 'losing'}">${game.homeScore}</div>
                            </div>
                        </div>
                        <div class="game-stats">
                            <div class="stat-item">
                                <div class="stat-label">Spread</div>
                                <div class="stat-value">${game.spread}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Total</div>
                                <div class="stat-value">${game.total}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">${game.venue ? 'Venue' : 'Neural'}</div>
                                <div class="stat-value">${game.venue || '97%'}</div>
                            </div>
                        </div>
                        ${playerStatsHTML}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function organizeGamesByWeek(games) {
            const gamesByWeek = new Map();
            const now = new Date();
            
            // 2025 NFL Season dates (approximate)
            const preseasonStart = new Date('2025-08-01');
            const seasonStart = new Date('2025-09-04'); // 2025 season start
            const seasonEnd = new Date('2026-01-31'); // End of playoffs
            
            games.forEach(game => {
                if (game.gameTime) {
                    const gameDate = new Date(game.gameTime);
                    let weekKey;
                    
                    // Determine if it's preseason, regular season, or playoffs
                    if (gameDate < seasonStart) {
                        weekKey = 'preseason';
                    } else if (gameDate > seasonEnd) {
                        weekKey = 'offseason';
                    } else {
                        // Calculate NFL week based on 2025 season structure
                        const daysSinceStart = Math.floor((gameDate - seasonStart) / (24 * 60 * 60 * 1000));
                        const week = Math.floor(daysSinceStart / 7) + 1;
                        
                        if (week <= 18) {
                            weekKey = week; // Regular season weeks 1-18
                        } else {
                            weekKey = 'playoffs'; // Playoff games
                        }
                    }
                    
                    if (!gamesByWeek.has(weekKey)) {
                        gamesByWeek.set(weekKey, []);
                    }
                    gamesByWeek.get(weekKey).push(game);
                }
            });
            
            console.log('üìÖ Games organized by week:', gamesByWeek);
            return gamesByWeek;
        }
        
        function getCurrentWeek() {
            const now = new Date();
            const seasonStart = new Date('2025-09-04'); // 2025 season start
            const preseasonStart = new Date('2025-08-01');
            
            if (now < preseasonStart) {
                return 'preseason'; // Before preseason
            } else if (now < seasonStart) {
                return 'preseason'; // During preseason
            }
            
            const daysSinceStart = Math.floor((now - seasonStart) / (24 * 60 * 60 * 1000));
            const week = Math.floor(daysSinceStart / 7) + 1;
            
            if (week <= 18) {
                return Math.max(1, Math.min(week, 18)); // Regular season weeks 1-18
            } else {
                return 'playoffs'; // Playoff time
            }
        }
        
        function getCurrentWeekDisplay() {
            const week = currentWeek === 'current' ? getCurrentWeek() : currentWeek;
            return week === 'preseason' ? 'preseason' : typeof week === 'number' ? `Week ${week}` : week;
        }
        
        function getGamesForWeek(week) {
            if (week === 'current') {
                week = getCurrentWeek();
            }
            return allWeekGames.get(week) || [];
        }

        function selectWeek(week, element) {
            console.log('üîÑ selectWeek called:', week, element);
            currentWeek = week;
            
            // Update week buttons (first row)
            document.querySelectorAll('.filter-tab').forEach(tab => {
                if (tab.parentElement === element.parentElement) {
                    tab.classList.remove('active');
                }
            });
            element.classList.add('active');
            
            // Get games for selected week
            liveGames = getGamesForWeek(currentWeek);
            renderScoreboard();
            
            updateStatus(`üìÖ Showing games for ${getCurrentWeekDisplay()}`);
        }

        function filterGames(filter, element) {
            currentFilter = filter;
            
            // Update filter tabs (second row)
            document.querySelectorAll('.filter-tab').forEach(tab => {
                if (tab.parentElement === element.parentElement) {
                    tab.classList.remove('active');
                }
            });
            element.classList.add('active');
            
            renderScoreboard();
            updateStatus(`üéØ Filter applied: ${filter} games`);
        }

        async function refreshScores() {
            updateStatus('üîÑ Refreshing quantum feed...');
            await loadLiveScores();
            resetRefreshCountdown();
        }

        // Use centralized API configuration
        function configureAPIKeys() {
            openAPIConfig();
        }

        function startAutoRefresh() {
            // Refresh every 30 seconds
            autoRefreshInterval = setInterval(() => {
                refreshScores();
            }, 30000);
            
            // Update countdown every second
            setInterval(() => {
                refreshCountdown--;
                if (refreshCountdown <= 0) {
                    refreshCountdown = 30;
                }
                document.getElementById('refresh-countdown').textContent = `${refreshCountdown}s`;
            }, 1000);
        }

        function resetRefreshCountdown() {
            refreshCountdown = 30;
        }

        function updateTicker() {
            const ticker = document.getElementById('neural-ticker');
            const messages = [
                'üß† NEURAL ANALYSIS: Real-time quantum probability calculations active',
                '‚öõÔ∏è QUANTUM SCORES: Processing infinite game outcome scenarios', 
                'üåå LIVE FEED: Synchronizing with parallel sports universes',
                'üìä AI PREDICTIONS: Neural networks achieving 97.3% accuracy',
                'üî¥ BREAKING: Quantum sports intelligence detecting momentum shifts'
            ];
            
            let messageIndex = 0;
            setInterval(() => {
                messageIndex = (messageIndex + 1) % messages.length;
                ticker.textContent = messages[messageIndex];
            }, 8000);
        }

        // ESPN Live Scores Integration
        async function fetchESPNScores() {
            try {
                console.log('üèà Fetching live scores from ESPN...');
                
                // ESPN NFL Scoreboard API (public endpoint)
                const response = await fetch('https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard');
                
                if (!response.ok) {
                    throw new Error(`ESPN API error: ${response.status}`);
                }
                
                const data = await response.json();

                // Also fetch additional player stats if available
                if (data.events) {
                    await Promise.all(data.events.map(async (event) => {
                        try {
                            // Fetch detailed game info including player stats
                            const gameResponse = await fetch(`https://site.api.espn.com/apis/site/v2/sports/football/nfl/summary?event=${event.id}`);
                            if (gameResponse.ok) {
                                const gameData = await gameResponse.json();
                                event.playerStats = gameData.leaders || null;
                                event.boxScore = gameData.boxscore || null;
                            }
                        } catch (error) {
                            console.warn(`Could not fetch detailed stats for game ${event.id}:`, error);
                        }
                    }));
                }
                
                if (data.events && data.events.length > 0) {
                    return data.events.map(event => {
                        const competition = event.competitions[0];
                        const homeTeam = competition.competitors.find(c => c.homeAway === 'home');
                        const awayTeam = competition.competitors.find(c => c.homeAway === 'away');
                        
                        // Map ESPN status to our filter status
                        const espnStatus = event.status.type.name.toLowerCase();
                        let filterStatus = 'upcoming';
                        if (espnStatus.includes('in_progress') || espnStatus.includes('in progress')) {
                            filterStatus = 'live';
                        } else if (espnStatus.includes('final')) {
                            filterStatus = 'final';
                        } else if (espnStatus.includes('scheduled') || espnStatus.includes('pre')) {
                            filterStatus = 'upcoming';
                        }

                        return {
                            id: `espn_${event.id}`,
                            provider: 'ESPN',
                            homeTeam: homeTeam.team.abbreviation,
                            awayTeam: awayTeam.team.abbreviation,
                            homeTeamName: homeTeam.team.displayName,
                            awayTeamName: awayTeam.team.displayName,
                            homeScore: homeTeam.score || '0',
                            awayScore: awayTeam.score || '0',
                            gameTime: event.date,
                            espnStatus: espnStatus,
                            status: filterStatus, // This is what our filter will use
                            statusLabel: event.status.type.shortDetail,
                            clock: competition.status?.displayClock || '',
                            period: competition.status?.period || 0,
                            spread: 'N/A',
                            total: 'N/A',
                            venue: competition.venue?.fullName || '',
                            logos: {
                                home: homeTeam.team.logo,
                                away: awayTeam.team.logo
                            },
                            colors: {
                                home: {
                                    primary: homeTeam.team.color || '#000000',
                                    alternate: homeTeam.team.alternateColor || '#FFFFFF'
                                },
                                away: {
                                    primary: awayTeam.team.color || '#000000',
                                    alternate: awayTeam.team.alternateColor || '#FFFFFF'
                                }
                            },
                            playerStats: event.playerStats || null,
                            boxScore: event.boxScore || null,
                            leaders: {
                                passing: event.playerStats?.find(stat => stat.name === 'passingLeader'),
                                rushing: event.playerStats?.find(stat => stat.name === 'rushingLeader'),
                                receiving: event.playerStats?.find(stat => stat.name === 'receivingLeader')
                            }
                        };
                    });
                }
                
                return [];
                
            } catch (error) {
                console.error('‚ùå Failed to fetch ESPN scores:', error);
                return [];
            }
        }

        // Merge ESPN scores with odds data
        function mergeScoresWithOdds(espnScores, oddsData) {
            const mergedGames = [...espnScores];
            
            // Add betting lines to ESPN scores where possible
            oddsData.forEach(provider => {
                if (provider.games) {
                    provider.games.forEach(oddsGame => {
                        const matchingGame = mergedGames.find(espnGame => 
                            (espnGame.homeTeam === oddsGame.homeTeam && espnGame.awayTeam === oddsGame.awayTeam) ||
                            (espnGame.homeTeamName?.includes(oddsGame.homeTeam) || espnGame.awayTeamName?.includes(oddsGame.awayTeam))
                        );
                        
                        if (matchingGame && oddsGame.bets) {
                            matchingGame.spread = oddsGame.bets?.spread?.home?.line || 'N/A';
                            matchingGame.total = oddsGame.bets?.totals?.over?.line || 'N/A';
                        }
                    });
                }
            });
            
            return mergedGames;
        }

        // Update odds widget based on season
        function updateOddsWidget() {
            const iframe = document.querySelector('iframe[title="Sunday Edge Pro - Live NFL Odds"]');
            const header = document.querySelector('.odds-widget-container h3');
            
            if (iframe && header) {
                let sport = 'americanfootball_nfl_preseason';
                let title = 'üèà Hard Rock Bet - NFL Preseason';
                
                // Check if we're in regular season
                const now = new Date();
                const seasonStart = new Date('2024-09-01');
                
                if (now >= seasonStart) {
                    sport = 'americanfootball_nfl';
                    title = 'üèà Hard Rock Bet - NFL Regular Season';
                }
                
                // Update the widget URL
                const baseUrl = 'https://widget.the-odds-api.com/v1/sports/';
                const accessKey = 'wk_c1f30f86cb719d970238ce3e1583d7c3';
                const params = 'accessKey=' + accessKey + '&bookmakerKeys=hardrockbet&oddsFormat=american&markets=h2h%2Cspreads%2Ctotals&marketNames=h2h%3AMoneyline%2Cspreads%3ASpreads%2Ctotals%3AOver%2FUnder';
                
                iframe.src = `${baseUrl}${sport}/events/?${params}`;
                header.textContent = title;
                
                console.log(`üìä Updated odds widget for ${sport}`);
            }
        }

        function updateStatus(message, type = 'success') {
            const indicator = document.getElementById('statusIndicator');
            if (indicator) {
                indicator.textContent = message;
                
                // Neural pulse effect
                indicator.style.animation = 'none';
                setTimeout(() => {
                    indicator.style.animation = 'statusPulse 2s ease-in-out infinite';
                }, 10);
            }
        }
    </script>
</body>
</html>