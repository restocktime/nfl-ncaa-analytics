<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- REMOVE CSP RESTRICTIONS FOR API CONNECTIONS -->
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:; script-src * 'unsafe-inline' 'unsafe-eval'; connect-src * 'unsafe-inline'; img-src * data: blob: 'unsafe-inline'; frame-src *; style-src * 'unsafe-inline';">
    
    <title>Fantasy Hub - Modern Fantasy Football Management</title>
    
    <!-- Modern Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Preload Font Awesome for faster loading -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://use.fontawesome.com">
    
    <!-- Modern Icons with Multiple CDN Fallbacks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css" media="print" onload="this.media='all'; this.onload=null;" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css" media="print" onload="this.media='all'; this.onload=null;" crossorigin="anonymous">
    
    <!-- EMERGENCY DEPLOYED SITE FIX -->
    <script src="fix-deployed-site.js"></script>
    
    <!-- Fallback for when Font Awesome fails to load -->
    <style>
      /* Icon fallbacks using Unicode symbols and emojis */
      .fas.fa-football-ball:before, .fas.fa-football:before { content: "üèà"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-chart-line:before { content: "üìà"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-users:before { content: "üë•"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-user:before { content: "üë§"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-search:before { content: "üîç"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-exchange-alt:before { content: "üîÑ"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-cog:before { content: "‚öôÔ∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-rocket:before { content: "üöÄ"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-trophy:before { content: "üèÜ"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-fire:before { content: "üî•"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-star:before { content: "‚≠ê"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-check:before { content: "‚úÖ"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-times:before { content: "‚ùå"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-exclamation-triangle:before { content: "‚ö†Ô∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-info-circle:before { content: "‚ÑπÔ∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-bell:before { content: "üîî"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-heart:before { content: "‚ù§Ô∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-thumbs-up:before { content: "üëç"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-link:before { content: "üîó"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-plug:before { content: "üîå"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-wifi:before { content: "üì∂"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-database:before { content: "üíæ"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-download:before { content: "‚¨áÔ∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-upload:before { content: "‚¨ÜÔ∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-sync:before { content: "üîÑ"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-play:before { content: "‚ñ∂Ô∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-pause:before { content: "‚è∏Ô∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      .fas.fa-stop:before { content: "‚èπÔ∏è"; font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif; }
      
      /* Ensure icons display properly even without Font Awesome */
      .fas:before, .far:before, .fab:before {
        font-weight: normal;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
      }
      
      /* Force emoji rendering when Font Awesome isn't available */
      .icon-fallback-active .fas:before,
      .icon-fallback-active .far:before,
      .icon-fallback-active .fab:before {
        font-family: "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif !important;
      }
    
    <style>
      /* Modern CSS Reset */
      *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      /* CSS Custom Properties for theming */
      :root {
        /* Modern color palette */
        --bg-primary: #0f0f23;
        --bg-secondary: #1a1a2e;
        --bg-tertiary: #16213e;
        --bg-card: #1e1e3f;
        --bg-card-hover: #252654;
        
        --text-primary: #ffffff;
        --text-secondary: #b0b3c1;
        --text-muted: #8b8da6;
        
        --accent-primary: #6366f1;
        --accent-secondary: #8b5cf6;
        --accent-success: #10b981;
        --accent-warning: #f59e0b;
        --accent-danger: #ef4444;
        
        --border-primary: rgba(255, 255, 255, 0.08);
        --border-secondary: rgba(255, 255, 255, 0.15);
        
        /* Modern shadows */
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
        --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.15), 0 10px 10px rgba(0, 0, 0, 0.04);
        
        /* Modern spacing */
        --space-xs: 0.25rem;
        --space-sm: 0.5rem;
        --space-md: 1rem;
        --space-lg: 1.5rem;
        --space-xl: 2rem;
        --space-2xl: 3rem;
        
        /* Modern typography */
        --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        --font-mono: 'JetBrains Mono', monospace;
        
        /* Modern borders */
        --radius-sm: 0.375rem;
        --radius-md: 0.5rem;
        --radius-lg: 0.75rem;
        --radius-xl: 1rem;
        --radius-2xl: 1.5rem;
      }

      /* Base styles */
      body {
        font-family: var(--font-primary);
        background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Modern container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--space-md);
      }

      /* Modern header with glassmorphism */
      .header {
        background: rgba(30, 30, 63, 0.8);
        backdrop-filter: blur(20px);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-2xl);
        padding: var(--space-2xl);
        margin-bottom: var(--space-2xl);
        text-align: center;
        box-shadow: var(--shadow-xl);
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
        opacity: 0.6;
      }

      .header h1 {
        font-size: clamp(2rem, 5vw, 3.5rem);
        font-weight: 800;
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: var(--space-sm);
        letter-spacing: -0.02em;
      }

      .header p {
        font-size: 1.125rem;
        color: var(--text-secondary);
        margin-bottom: var(--space-xl);
        font-weight: 400;
      }

      /* Modern button group */
      .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-md);
        justify-content: center;
        align-items: center;
      }

      .modern-btn {
        display: inline-flex;
        align-items: center;
        gap: var(--space-sm);
        padding: var(--space-md) var(--space-xl);
        border: none;
        border-radius: var(--radius-lg);
        font-family: var(--font-primary);
        font-weight: 600;
        font-size: 0.9rem;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        box-shadow: var(--shadow-md);
        backdrop-filter: blur(10px);
      }

      .modern-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transition: left 0.5s ease;
      }

      .modern-btn:hover::before {
        left: 100%;
      }

      .modern-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--accent-success), #059669);
        color: white;
      }

      .btn-secondary {
        background: linear-gradient(135deg, var(--accent-warning), #d97706);
        color: white;
      }

      .btn-tertiary {
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        color: white;
      }

      /* Modern navigation grid */
      .nav-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--space-lg);
        margin-bottom: var(--space-2xl);
      }

      /* Modern navigation cards */
      .nav-card {
        background: rgba(30, 30, 63, 0.6);
        backdrop-filter: blur(20px);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-xl);
        padding: var(--space-xl);
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        box-shadow: var(--shadow-md);
      }

      .nav-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        transform: scaleX(0);
        transition: transform 0.3s ease;
        transform-origin: left;
      }

      .nav-card:hover::before {
        transform: scaleX(1);
      }

      .nav-card:hover {
        transform: translateY(-8px);
        background: rgba(37, 38, 84, 0.8);
        border-color: var(--border-secondary);
        box-shadow: var(--shadow-xl);
      }

      .nav-card-icon {
        font-size: 2.5rem;
        margin-bottom: var(--space-md);
        color: var(--accent-primary);
        transition: all 0.3s ease;
      }

      .nav-card:hover .nav-card-icon {
        transform: scale(1.1);
        color: var(--accent-secondary);
      }

      .nav-card h3 {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: var(--space-sm);
        letter-spacing: -0.01em;
      }

      .nav-card p {
        color: var(--text-secondary);
        font-size: 0.9rem;
        line-height: 1.5;
      }

      /* Modern back button */
      .back-btn {
        position: fixed;
        top: var(--space-lg);
        right: var(--space-lg);
        display: flex;
        align-items: center;
        gap: var(--space-sm);
        background: rgba(30, 30, 63, 0.9);
        backdrop-filter: blur(20px);
        color: var(--text-primary);
        padding: var(--space-sm) var(--space-md);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-lg);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.875rem;
        transition: all 0.3s ease;
        z-index: 1000;
        box-shadow: var(--shadow-md);
      }

      .back-btn:hover {
        background: rgba(99, 102, 241, 0.2);
        border-color: var(--accent-primary);
        transform: translateY(-1px);
        box-shadow: var(--shadow-lg);
      }

      /* Modern content sections */
      .content {
        background: rgba(30, 30, 63, 0.6);
        backdrop-filter: blur(20px);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-2xl);
        padding: var(--space-2xl);
        margin-top: var(--space-2xl);
        display: none;
        box-shadow: var(--shadow-lg);
        position: relative;
        overflow: hidden;
      }

      .content::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
        opacity: 0.6;
      }

      .content.active {
        display: block;
        animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .content h2 {
        font-size: 2rem;
        font-weight: 700;
        background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: var(--space-lg);
        letter-spacing: -0.02em;
      }

      /* Modern feature grid */
      .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--space-lg);
      }

      /* Modern feature cards */
      .feature-card {
        background: rgba(22, 33, 62, 0.8);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-lg);
        padding: var(--space-xl);
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
        position: relative;
        overflow: hidden;
      }

      .feature-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
        transition: left 0.5s ease;
      }

      .feature-card:hover::before {
        left: 100%;
      }

      .feature-card:hover {
        border-color: var(--border-secondary);
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
      }

      .feature-card h4 {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: var(--space-md);
        letter-spacing: -0.01em;
      }

      .feature-card p {
        color: var(--text-secondary);
        font-size: 0.9rem;
        line-height: 1.6;
        margin-bottom: var(--space-sm);
      }

      .feature-card p:last-child {
        margin-bottom: 0;
      }

      /* Modern status indicator */
      .status {
        position: fixed;
        bottom: var(--space-lg);
        left: var(--space-lg);
        background: rgba(30, 30, 63, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid var(--border-primary);
        border-radius: var(--radius-lg);
        padding: var(--space-sm) var(--space-md);
        color: var(--accent-success);
        font-size: 0.875rem;
        font-weight: 500;
        box-shadow: var(--shadow-md);
        z-index: 1000;
        transition: all 0.3s ease;
      }

      /* Modern animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.8; }
      }

      .pulse {
        animation: pulse 2s infinite;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .container {
          padding: var(--space-sm);
        }
        
        .header {
          padding: var(--space-lg);
          margin-bottom: var(--space-lg);
        }
        
        .button-group {
          flex-direction: column;
          width: 100%;
        }
        
        .modern-btn {
          width: 100%;
          justify-content: center;
        }
        
        .nav-grid {
          grid-template-columns: 1fr;
          gap: var(--space-md);
        }
        
        .nav-card {
          padding: var(--space-lg);
        }
        
        .feature-grid {
          grid-template-columns: 1fr;
          gap: var(--space-md);
        }
        
        .content {
          padding: var(--space-lg);
          margin-top: var(--space-lg);
        }
        
        .back-btn {
          top: var(--space-md);
          right: var(--space-md);
        }
        
        .status {
          bottom: var(--space-md);
          left: var(--space-md);
          right: var(--space-md);
          text-align: center;
        }
      }

      @media (max-width: 480px) {
        .header h1 {
          font-size: 2rem;
        }
        
        .modern-btn {
          padding: var(--space-sm) var(--space-lg);
          font-size: 0.85rem;
        }
        
        .nav-card-icon {
          font-size: 2rem;
        }
        
        .nav-card h3 {
          font-size: 1.125rem;
        }
        
        .content h2 {
          font-size: 1.5rem;
        }
      }

      /* Modern utility classes */
      .text-gradient {
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .glass-effect {
        background: rgba(30, 30, 63, 0.6);
        backdrop-filter: blur(20px);
        border: 1px solid var(--border-primary);
      }

      .hover-lift:hover {
        transform: translateY(-4px);
        transition: transform 0.3s ease;
      }
    </style>
  </head>
  <body>
    <a href="index.html" class="back-btn">‚Üê Back to NFL Analytics</a>

    <div class="container">
      <div class="header">
        <h1>üèà Fantasy Football Hub</h1>
        <p>Your complete fantasy football management center</p>
        <div style="margin-top: 20px">
          <a
            href="connect-accounts.html"
            style="
              background: linear-gradient(135deg, #10b981 0%, #059669 100%);
              color: white;
              padding: 15px 30px;
              text-decoration: none;
              border-radius: 10px;
              font-weight: bold;
              display: inline-block;
              margin-right: 15px;
              transition: all 0.3s ease;
            "
            onmouseover="this.style.transform='translateY(-2px)'"
            onmouseout="this.style.transform='translateY(0)'"
          >
            üîó Connect Your Accounts
          </a>
          <a
            href="roster-builder.html"
            style="
              background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
              color: white;
              padding: 15px 30px;
              text-decoration: none;
              border-radius: 10px;
              font-weight: bold;
              display: inline-block;
              margin-right: 15px;
              transition: all 0.3s ease;
            "
            onmouseover="this.style.transform='translateY(-2px)'"
            onmouseout="this.style.transform='translateY(0)'"
          >
            üë• Build Manually
          </a>
          <a
            href="revolutionary-fantasy-hub.html"
            style="
              background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
              color: white;
              padding: 15px 30px;
              text-decoration: none;
              border-radius: 10px;
              font-weight: bold;
              display: inline-block;
              margin-right: 15px;
              transition: all 0.3s ease;
            "
            onmouseover="this.style.transform='translateY(-2px)'"
            onmouseout="this.style.transform='translateY(0)'"
          >
            üöÄ Revolutionary Hub
          </a>
        </div>
      </div>

      <div class="nav-grid">
        <div class="nav-card" onclick="showSection('dashboard')">
          <h3>üìä Fantasy Dashboard</h3>
          <p>Overview of your team and weekly performance</p>
        </div>

        <div class="nav-card" onclick="showSection('lineup')">
          <h3>üë• Lineup Optimizer</h3>
          <p>AI-powered lineup recommendations</p>
        </div>

        <div class="nav-card" onclick="showSection('waivers')">
          <h3>üîç Waiver Wire</h3>
          <p>Smart waiver wire analysis</p>
        </div>

        <div class="nav-card" onclick="showSection('trades')">
          <h3>üîÑ Trade Analyzer</h3>
          <p>Advanced trade evaluation</p>
        </div>

        <div class="nav-card" onclick="showSection('projections')">
          <h3>üìà Player Projections</h3>
          <p>ML-powered performance projections</p>
        </div>

        <div class="nav-card" onclick="showSection('roster')">
          <h3>üë• My Roster</h3>
          <p>View and manage your fantasy roster</p>
        </div>

        <div class="nav-card" onclick="showSection('settings')">
          <h3>‚öôÔ∏è League Setup</h3>
          <p>Configure your league settings</p>
        </div>
      </div>

      <div id="dashboard" class="content">
        <h2>üìä Fantasy Dashboard</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Loading Your Optimal Lineup...</h4>
            <p>üîÑ Fetching your roster data...</p>
          </div>
          <div class="feature-card">
            <h4>This Week's Matchups</h4>
            <p>üîÑ Loading matchup data...</p>
          </div>
          <div class="feature-card">
            <h4>Injury Watch</h4>
            <p>üîÑ Checking injury reports...</p>
          </div>
          <div class="feature-card">
            <h4>Breaking Fantasy News</h4>
            <p>üîÑ Loading latest news...</p>
          </div>
        </div>
      </div>

      <div id="lineup" class="content">
        <h2>üë• Lineup Optimizer</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Your Lineup Analysis</h4>
            <p>üîÑ Analyzing your roster...</p>
          </div>
          <div class="feature-card">
            <h4>Lineup Recommendations</h4>
            <p>üîÑ Calculating optimal changes...</p>
          </div>
          <div class="feature-card">
            <h4>Risk Analysis</h4>
            <p>üîÑ Assessing roster risk...</p>
          </div>
          <div class="feature-card">
            <h4>Your Players This Week</h4>
            <p>üîÑ Loading matchup grades...</p>
          </div>
        </div>
      </div>

      <div id="waivers" class="content">
        <h2>üîç Waiver Wire Intelligence</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Top Waiver Targets</h4>
            <p>üîÑ Scanning waiver wire...</p>
          </div>
          <div class="feature-card">
            <h4>Breakout Candidates</h4>
            <p>üîÑ Identifying breakout players...</p>
          </div>
          <div class="feature-card">
            <h4>Injury Replacements</h4>
            <p>üîÑ Monitoring injury reports...</p>
          </div>
          <div class="feature-card">
            <h4>Trending Up</h4>
            <p>üîÑ Analyzing player trends...</p>
          </div>
        </div>
      </div>

      <div id="trades" class="content">
        <h2>üîÑ Trade Analyzer</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Trade Opportunities</h4>
            <p>üîÑ Analyzing trade opportunities...</p>
          </div>
          <div class="feature-card">
            <h4>Your Player Values</h4>
            <p>üîÑ Calculating market values...</p>
          </div>
          <div class="feature-card">
            <h4>Trade Calculator</h4>
            <p>üîÑ Loading trade tools...</p>
          </div>
          <div class="feature-card">
            <h4>Trade Tips</h4>
            <p>üîÑ Loading trade insights...</p>
          </div>
        </div>
      </div>

      <div id="projections" class="content">
        <h2>üìà Player Projections</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Top QB Projections</h4>
            <p>üîÑ Loading QB projections...</p>
          </div>
          <div class="feature-card">
            <h4>Top RB Projections</h4>
            <p>üîÑ Loading RB projections...</p>
          </div>
          <div class="feature-card">
            <h4>Top WR Projections</h4>
            <p>üîÑ Loading WR projections...</p>
          </div>
          <div class="feature-card">
            <h4>Top TE Projections</h4>
            <p>üîÑ Loading TE projections...</p>
          </div>
        </div>
      </div>

      <div id="roster" class="content">
        <h2>üë• My Fantasy Roster</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Starting Lineup</h4>
            <div id="starting-lineup-display">
              <p>Loading your optimal lineup...</p>
            </div>
          </div>
          <div class="feature-card">
            <h4>Bench Players</h4>
            <div id="bench-players-display">
              <p>Loading bench players...</p>
            </div>
          </div>
          <div class="feature-card">
            <h4>Roster Stats</h4>
            <div id="roster-stats-display">
              <p>Calculating roster statistics...</p>
            </div>
          </div>
          <div class="feature-card">
            <h4>Sit/Start Recommendations</h4>
            <div id="sit-start-display">
              <p>Analyzing sit/start decisions...</p>
            </div>
          </div>
        </div>
      </div>

      <div id="settings" class="content">
        <h2>‚öôÔ∏è League Configuration</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h4>Import League</h4>
            <p>Connect to ESPN, Yahoo, or Sleeper</p>
            <p>Automatic roster sync</p>
            <p>League settings import</p>
            <p>Scoring system detection</p>
          </div>
          <div class="feature-card" id="league-settings-display">
            <h4>League Settings</h4>
            <p>üîÑ Loading league configuration...</p>
          </div>
          <div class="feature-card" id="waiver-settings-display">
            <h4>Waiver Settings</h4>
            <p>üîÑ Loading waiver rules...</p>
          </div>
          <div class="feature-card" id="playoff-settings-display">
            <h4>Playoff Settings</h4>
            <p>üîÑ Loading playoff format...</p>
          </div>
        </div>
      </div>
    </div>

    <div class="status" id="status">Fantasy Hub loaded successfully ‚úÖ</div>

    <!-- Comprehensive Icon Fallback System -->
    <script>
      // Comprehensive Font Awesome fallback system
      function initIconFallbacks() {
        console.log('üîß Initializing Fantasy Hub icon fallback system...');
        
        // Test if Font Awesome is loaded
        const testElement = document.createElement('i');
        testElement.className = 'fas fa-home';
        testElement.style.position = 'absolute';
        testElement.style.left = '-9999px';
        testElement.style.visibility = 'hidden';
        document.body.appendChild(testElement);
        
        // Wait a bit for fonts to load
        setTimeout(() => {
          const computed = window.getComputedStyle(testElement, ':before');
          const content = computed.content;
          const fontFamily = computed.fontFamily;
          
          const isFontAwesome = fontFamily.includes('Font Awesome') || 
                              content !== 'none' && content !== '""' && content.charCodeAt(1) > 255;
          
          if (!isFontAwesome) {
            console.log('‚ö†Ô∏è Font Awesome not properly loaded on Fantasy Hub, activating emoji fallbacks');
            document.body.classList.add('icon-fallback-active');
            
            // Replace all Font Awesome icons with emojis
            replaceFontAwesomeWithEmojis();
          } else {
            console.log('‚úÖ Font Awesome loaded successfully on Fantasy Hub');
          }
          
          document.body.removeChild(testElement);
        }, 200);
      }
      
      function replaceFontAwesomeWithEmojis() {
        const iconMap = {
          'fa-football-ball': 'üèà',
          'fa-football': 'üèà',
          'fa-chart-line': 'üìà',
          'fa-users': 'üë•',
          'fa-user-friends': 'üë•',
          'fa-user': 'üë§',
          'fa-search': 'üîç',
          'fa-exchange-alt': 'üîÑ',
          'fa-cog': '‚öôÔ∏è',
          'fa-rocket': 'üöÄ',
          'fa-trophy': 'üèÜ',
          'fa-fire': 'üî•',
          'fa-star': '‚≠ê',
          'fa-check': '‚úÖ',
          'fa-times': '‚ùå',
          'fa-exclamation-triangle': '‚ö†Ô∏è',
          'fa-info-circle': '‚ÑπÔ∏è',
          'fa-bell': 'üîî',
          'fa-heart': '‚ù§Ô∏è',
          'fa-thumbs-up': 'üëç',
          'fa-link': 'üîó',
          'fa-plug': 'üîå',
          'fa-wifi': 'üì∂',
          'fa-database': 'üíæ',
          'fa-download': '‚¨áÔ∏è',
          'fa-upload': '‚¨ÜÔ∏è',
          'fa-sync': 'üîÑ',
          'fa-refresh': 'üîÑ',
          'fa-sync-alt': 'üîÑ',
          'fa-play': '‚ñ∂Ô∏è',
          'fa-pause': '‚è∏Ô∏è',
          'fa-stop': '‚èπÔ∏è',
          'fa-chart-bar': 'üìä',
          'fa-calendar': 'üìÖ',
          'fa-calendar-alt': 'üìÖ',
          'fa-home': 'üè†',
          'fa-tachometer-alt': '‚ö°',
          'fa-bolt': '‚ö°',
          'fa-magic': '‚ú®',
          'fa-lightbulb': 'üí°',
          'fa-gamepad': 'üéÆ',
          'fa-newspaper': 'üì∞',
          'fa-clock': '‚è∞',
          'fa-history': 'üïí',
          'fa-external-link-alt': 'üîó'
        };
        
        // Replace all icon elements with emojis
        document.querySelectorAll('i[class*="fa-"]').forEach(element => {
          const classList = Array.from(element.classList);
          let emoji = '';
          
          for (const className of classList) {
            if (iconMap[className]) {
              emoji = iconMap[className];
              break;
            }
          }
          
          if (emoji) {
            element.innerHTML = emoji;
            element.style.fontFamily = '"Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji", sans-serif';
            element.style.fontWeight = 'normal';
            console.log(`üîÑ Replaced ${classList.join(' ')} with ${emoji}`);
          }
        });
      }
      
      // Initialize when DOM is ready
      document.addEventListener('DOMContentLoaded', function() {
        // Wait a bit for stylesheets to load
        setTimeout(initIconFallbacks, 300);
      });
      
      // Also check after window load as backup
      window.addEventListener('load', function() {
        setTimeout(initIconFallbacks, 100);
      });
    </script>

    <!-- Load Fantasy Data Service -->
    <script src="fantasy-api-integration.js"></script>
    <script src="fantasy-data-service.js"></script>
    <script src="fantasy-news-service.js"></script>
    <script src="fantasy-roster-manager.js"></script>
    
    <script>
      console.log("Fantasy Hub loaded successfully");

      // Initialize live data when page loads
      let fantasyApp;
      let fantasyNewsApp;
      let fantasyRosterApp;
      
      document.addEventListener('DOMContentLoaded', async function() {
        await initializeAPIIntegration();
        await initializeLiveData();
        await initializeNewsService();
        await initializeRosterManager();
        await checkUserRoster();
        loadDashboardData();
        
        // Update data every 5 minutes
        setInterval(loadDashboardData, 5 * 60 * 1000);
        setInterval(loadNewsData, 10 * 60 * 1000);
      });

      async function initializeAPIIntegration() {
        console.log('üîó Initializing API Integration...');
        
        // Wait for API integration service to be available
        let attempts = 0;
        while (!window.fantasyAPIIntegration && attempts < 50) {
          await new Promise(resolve => setTimeout(resolve, 100));
          attempts++;
        }
        
        if (window.fantasyAPIIntegration) {
          console.log('‚úÖ Fantasy API Integration connected');
        } else {
          console.warn('‚ö†Ô∏è Fantasy API Integration not found');
        }
      }

      async function checkUserRoster() {
        console.log('üîç Checking for user roster...');
        
        const userRoster = localStorage.getItem('userFantasyRoster');
        const connectedPlatforms = window.fantasyAPIIntegration ? 
          window.fantasyAPIIntegration.getConnectedPlatforms() : [];
        
        if (!userRoster && connectedPlatforms.length === 0) {
          // No roster and no connections - show setup message
          showRosterSetupMessage();
        } else if (userRoster) {
          const roster = JSON.parse(userRoster);
          console.log(`‚úÖ Found user roster: ${roster.teamName} (${roster.roster.length} players)`);
          updateUserInfo(roster);
        }
      }

      function showRosterSetupMessage() {
        const dashboardCards = document.querySelectorAll('#dashboard .feature-card');
        if (dashboardCards.length > 0) {
          dashboardCards[0].innerHTML = `
            <h4>üèà Welcome to Fantasy Hub!</h4>
            <p>To get started, you need to connect your fantasy account or build your roster:</p>
            <div style="margin: 15px 0;">
              <button onclick="window.location.href='connect-accounts.html'" 
                style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 500;">
                üîó Connect Fantasy Account
              </button>
              <button onclick="window.location.href='roster-builder.html'" 
                style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 500;">
                üèà Build Manual Roster
              </button>
            </div>
            <p style="font-size: 0.9em; color: #94a3b8;">Once connected, you'll see your optimal lineup, injury alerts, and personalized recommendations here!</p>
          `;
        }
      }

      function updateUserInfo(roster) {
        // Update the header with user info
        const headerStatus = document.querySelector('.header .feature-preview');
        if (headerStatus) {
          headerStatus.innerHTML = `
            <div style="text-align: center; padding: 15px;">
              <h3 style="color: #10b981; margin: 0 0 8px 0;">üèÜ ${roster.teamName}</h3>
              <p style="margin: 0; color: #cbd5e1;">
                ${roster.record.wins}-${roster.record.losses} ‚Ä¢ ${roster.roster.length} Players ‚Ä¢ 
                ${roster.platform ? roster.platform.toUpperCase() : 'Custom'} League
              </p>
            </div>
          `;
        }
      }

      async function initializeLiveData() {
        console.log('üèà Initializing Fantasy Live Data...');
        
        // Wait for fantasy data service to be available
        let attempts = 0;
        while (!window.fantasyDataService && attempts < 50) {
          await new Promise(resolve => setTimeout(resolve, 100));
          attempts++;
        }
        
        if (window.fantasyDataService) {
          fantasyApp = window.fantasyDataService;
          console.log('‚úÖ Fantasy Data Service connected');
        } else {
          console.warn('‚ö†Ô∏è Fantasy Data Service not found, using mock data');
        }
      }

      async function initializeNewsService() {
        console.log('üì∞ Initializing Fantasy News Service...');
        
        // Wait for fantasy news service to be available
        let attempts = 0;
        while (!window.fantasyNewsService && attempts < 50) {
          await new Promise(resolve => setTimeout(resolve, 100));
          attempts++;
        }
        
        if (window.fantasyNewsService) {
          fantasyNewsApp = window.fantasyNewsService;
          console.log('‚úÖ Fantasy News Service connected');
          loadNewsData();
        } else {
          console.warn('‚ö†Ô∏è Fantasy News Service not found');
        }
      }

      async function loadNewsData() {
        if (!fantasyNewsApp) return;
        
        try {
          // Update injury watch in dashboard
          const injuryReports = fantasyNewsApp.getInjuryAlerts();
          updateInjuryWatch(injuryReports);
          
          // Update breaking news
          const breakingNews = fantasyNewsApp.getBreakingNews(3);
          updateBreakingNews(breakingNews);
          
        } catch (error) {
          console.error('‚ùå Error loading news data:', error);
        }
      }

      async function initializeRosterManager() {
        console.log('üë• Initializing Fantasy Roster Manager...');
        
        // Wait for fantasy roster manager to be available
        let attempts = 0;
        while (!window.fantasyRosterManager && attempts < 50) {
          await new Promise(resolve => setTimeout(resolve, 100));
          attempts++;
        }
        
        if (window.fantasyRosterManager) {
          fantasyRosterApp = window.fantasyRosterManager;
          console.log('‚úÖ Fantasy Roster Manager connected');
          
          // Display current user info
          const currentRoster = fantasyRosterApp.getUserRoster();
          if (currentRoster) {
            console.log(`üë§ Loaded roster for: ${currentRoster.teamName} (${currentRoster.roster.length} players)`);
          }
        } else {
          console.warn('‚ö†Ô∏è Fantasy Roster Manager not found');
        }
      }

      async function loadDashboardData() {
        if (!fantasyApp || !fantasyRosterApp) return;
        
        try {
          console.log('üîÑ Loading live fantasy data with user roster...');
          updateStatus('üîÑ Loading optimal lineup from your roster...', 'loading');
          
          // Generate optimal lineup from user's actual roster
          const optimalLineupData = await fantasyRosterApp.generateOptimalLineup();
          if (optimalLineupData) {
            updateOptimalLineup(optimalLineupData);
          }
          
          // Load waiver wire targets
          const waiverTargets = await fantasyApp.getWaiverWireTargets();
          updateWaiverWire(waiverTargets);
          
          // Load NFL schedule for matchups
          const schedule = await fantasyApp.getNFLSchedule();
          updateMatchupInfo(schedule);
          
          updateStatus('‚úÖ Live data loaded with your roster', 'success');
          
        } catch (error) {
          console.error('‚ùå Error loading live data:', error);
          updateStatus('‚ùå Error loading live data', 'error');
        }
      }

      function updateOptimalLineup(lineupData) {
        const lineupCard = document.querySelector('#dashboard .feature-card');
        if (!lineupCard || !lineupData.lineup.length) return;
        
        const currentRoster = fantasyRosterApp.getUserRoster();
        
        let lineupHTML = `<h4>${currentRoster.teamName} - Optimal Lineup</h4>`;
        
        // Group players by lineup position
        const positions = ['QB', 'RB', 'WR', 'TE', 'FLEX', 'K', 'DEF'];
        
        positions.forEach(position => {
          const positionPlayers = lineupData.lineup.filter(p => p.lineupPosition === position);
          
          if (position === 'RB' || position === 'WR') {
            // Handle multiple RB/WR positions
            positionPlayers.forEach((player, index) => {
              const posLabel = `${position}${index + 1}`;
              lineupHTML += `<p><strong>${posLabel}:</strong> ${player.name} (${player.team}) - ${player.projection} pts</p>`;
            });
          } else if (positionPlayers.length > 0) {
            const player = positionPlayers[0];
            lineupHTML += `<p><strong>${position}:</strong> ${player.name} (${player.team}) - ${player.projection} pts</p>`;
          }
        });
        
        lineupHTML += `<p style="color: #4ade80; font-weight: bold">Projected Total: ${lineupData.totalProjection.toFixed(1)} points</p>`;
        lineupHTML += `<p style="color: #fbbf24; font-size: 0.9em">Confidence: ${lineupData.confidence}</p>`;
        
        // Add top recommendation if available
        if (lineupData.recommendations.length > 0) {
          const topRec = lineupData.recommendations[0];
          lineupHTML += `<p style="color: #60a5fa; font-size: 0.9em">üí° ${topRec.message}</p>`;
        }
        
        lineupCard.innerHTML = lineupHTML;
      }

      function updateInjuryWatch(injuries) {
        const injuryCard = document.querySelector('#dashboard .feature-card:nth-child(3)');
        if (!injuryCard) return;
        
        let injuryHTML = '<h4>Injury Watch (Live Data)</h4>';
        
        if (injuries.length > 0) {
          injuries.slice(0, 4).forEach(injury => {
            const icon = fantasyNewsApp.getStatusIcon(injury.gameStatus);
            injuryHTML += `<p>${icon} ${injury.player} (${injury.team}) - ${injury.injury}</p>`;
          });
        } else {
          injuryHTML += '<p>‚úÖ No major injury concerns this week</p>';
          injuryHTML += '<p>üìÖ Monitor practice reports Wednesday</p>';
        }
        
        injuryCard.innerHTML = injuryHTML;
      }

      function updateBreakingNews(news) {
        const outlookCard = document.querySelector('#dashboard .feature-card:nth-child(4)');
        if (!outlookCard || !news.length) return;
        
        let newsHTML = '<h4>Breaking Fantasy News</h4>';
        
        news.forEach(item => {
          const timeAgo = fantasyNewsApp.formatTimeAgo(item.timestamp);
          newsHTML += `<p>üì∞ ${item.headline} (${timeAgo})</p>`;
        });
        
        if (news.length === 0) {
          newsHTML += '<p>üìà No breaking news - check back later</p>';
        }
        
        outlookCard.innerHTML = newsHTML;
      }

      function updateWaiverWire(targets) {
        const waiverSection = document.getElementById('waivers');
        if (!waiverSection || !targets.length) return;
        
        const topTargetsCard = waiverSection.querySelector('.feature-card');
        if (!topTargetsCard) return;
        
        let waiverHTML = '<h4>Top Waiver Targets (Live Data)</h4>';
        targets.slice(0, 5).forEach((target, index) => {
          waiverHTML += `<p>${index + 1}. ${target.name} (${target.position}, ${target.team}) - ${target.score}% opportunity score</p>`;
        });
        
        topTargetsCard.innerHTML = waiverHTML;
      }

      function updateMatchupInfo(schedule) {
        const matchupCard = document.querySelector('#dashboard .feature-card:nth-child(2)');
        if (!matchupCard || !schedule.length) return;
        
        let matchupHTML = '<h4>This Week\'s Matchups (Live Data)</h4>';
        schedule.slice(0, 4).forEach(game => {
          const gameTime = new Date(game.date).toLocaleDateString();
          matchupHTML += `<p>${game.awayTeam} @ ${game.homeTeam} (${gameTime})</p>`;
        });
        
        matchupCard.innerHTML = matchupHTML;
      }

      function updateStatus(message, type = 'info') {
        const statusElement = document.getElementById('status');
        if (!statusElement) return;
        
        statusElement.textContent = message;
        statusElement.className = 'status';
        
        // Add type-specific styling
        if (type === 'loading') {
          statusElement.style.color = '#fbbf24';
        } else if (type === 'success') {
          statusElement.style.color = '#4ade80';
        } else if (type === 'error') {
          statusElement.style.color = '#f87171';
        }
      }

      function showSection(sectionName) {
        console.log("Showing section:", sectionName);

        // Hide all content sections
        var sections = document.querySelectorAll(".content");
        for (var i = 0; i < sections.length; i++) {
          sections[i].classList.remove("active");
        }

        // Show selected section
        var targetSection = document.getElementById(sectionName);
        if (targetSection) {
          targetSection.classList.add("active");
          updateStatus("Showing " + sectionName + " section ‚úÖ");

          // Load section-specific data
          loadSectionData(sectionName);

          // Scroll to content
          targetSection.scrollIntoView({ behavior: "smooth" });
        } else {
          updateStatus("Error: " + sectionName + " section not found ‚ùå", 'error');
        }
      }

      async function loadSectionData(sectionName) {
        if (!fantasyApp || !fantasyRosterApp) return;
        
        try {
          switch (sectionName) {
            case 'lineup':
              await loadLineupOptimizerData();
              break;
            case 'projections':
              await loadProjectionsData();
              break;
            case 'waivers':
              await loadWaiverData();
              break;
            case 'roster':
              await loadRosterData();
              break;
            case 'trades':
              await loadTradeData();
              break;
            case 'settings':
              await loadSettingsData();
              break;
          }
        } catch (error) {
          console.error(`Error loading ${sectionName} data:`, error);
        }
      }

      async function loadLineupOptimizerData() {
        const lineupSection = document.getElementById('lineup');
        if (!lineupSection) return;
        
        const featureCards = lineupSection.querySelectorAll('.feature-card');
        
        // Get optimal lineup and analysis
        const optimalLineupData = await fantasyRosterApp.generateOptimalLineup();
        const sitStartRecommendations = fantasyRosterApp.getSitStartRecommendations();
        const rosterAnalysis = fantasyRosterApp.getRosterAnalysis();
        const currentRoster = fantasyRosterApp.getUserRoster();
        
        // Update optimization results
        if (featureCards[0] && optimalLineupData) {
          let optimizationHTML = '<h4>Your Lineup Analysis</h4>';
          optimizationHTML += `<p>Total Projected Points: <strong>${optimalLineupData.totalProjection.toFixed(1)}</strong></p>`;
          optimizationHTML += `<p>Lineup Confidence: <strong>${optimalLineupData.confidence}</strong></p>`;
          optimizationHTML += `<p>Team Record: <strong>${currentRoster.record.wins}-${currentRoster.record.losses}</strong></p>`;
          optimizationHTML += `<p>Playoff Seed: <strong>#${currentRoster.playoffSeed}</strong></p>`;
          featureCards[0].innerHTML = optimizationHTML;
        }
        
        // Update suggested changes
        if (featureCards[1] && optimalLineupData.recommendations.length > 0) {
          let changesHTML = '<h4>Lineup Recommendations</h4>';
          optimalLineupData.recommendations.slice(0, 3).forEach((rec, index) => {
            changesHTML += `<p>${index + 1}. ${rec.message}</p>`;
            if (rec.impact) {
              changesHTML += `<p style="color: #4ade80; font-size: 0.9em">   Impact: ${rec.impact}</p>`;
            }
          });
          featureCards[1].innerHTML = changesHTML;
        }
        
        // Update risk analysis
        if (featureCards[2]) {
          let riskHTML = '<h4>Roster Risk Analysis</h4>';
          
          // Count injured players
          const injuredPlayers = currentRoster.roster.filter(p => 
            p.injury && p.injury !== 'Healthy'
          );
          
          if (injuredPlayers.length > 0) {
            riskHTML += `<p style="color: #f97316">‚ö†Ô∏è ${injuredPlayers.length} players with injury concerns</p>`;
            injuredPlayers.slice(0, 2).forEach(player => {
              riskHTML += `<p style="font-size: 0.9em">   ${player.name} (${player.injury})</p>`;
            });
          } else {
            riskHTML += '<p style="color: #4ade80">‚úÖ No injury concerns this week</p>';
          }
          
          // Add depth analysis
          if (rosterAnalysis) {
            if (rosterAnalysis.weaknesses.length > 0) {
              riskHTML += `<p style="color: #fbbf24">üìä Depth Concerns: ${rosterAnalysis.weaknesses[0]}</p>`;
            }
          }
          
          featureCards[2].innerHTML = riskHTML;
        }
        
        // Update matchup grades with actual roster
        if (featureCards[3]) {
          let matchupHTML = '<h4>Your Players This Week</h4>';
          
          const starters = fantasyRosterApp.getStartingLineup();
          const positionGroups = {
            QB: starters.filter(p => p.position === 'QB'),
            RB: starters.filter(p => p.position === 'RB'),
            WR: starters.filter(p => p.position === 'WR'),
            TE: starters.filter(p => p.position === 'TE')
          };
          
          Object.entries(positionGroups).forEach(([pos, players]) => {
            if (players.length > 0) {
              const avgProjection = players.reduce((sum, p) => sum + fantasyRosterApp.getStaticProjection(p), 0) / players.length;
              let grade = avgProjection >= 18 ? 'A+' : avgProjection >= 15 ? 'A' : avgProjection >= 12 ? 'B+' : avgProjection >= 10 ? 'B' : 'C';
              matchupHTML += `<p><strong>${pos}:</strong> ${grade} (${players.map(p => p.name.split(' ')[1]).join(', ')})</p>`;
            }
          });
          
          featureCards[3].innerHTML = matchupHTML;
        }
        
        console.log('‚úÖ Lineup optimizer data loaded with user roster');
      }

      async function loadRosterData() {
        if (!fantasyRosterApp) return;
        
        const currentRoster = fantasyRosterApp.getUserRoster();
        
        // Check if user has a roster
        if (!currentRoster) {
          showRosterSetupInSection();
          return;
        }
        
        const optimalLineupData = await fantasyRosterApp.generateOptimalLineup();
        const sitStartRecommendations = fantasyRosterApp.getSitStartRecommendations();
        const rosterAnalysis = fantasyRosterApp.getRosterAnalysis();
        
        // Update starting lineup display
        const startingLineupDiv = document.getElementById('starting-lineup-display');
        if (startingLineupDiv && optimalLineupData) {
          let lineupHTML = '';
          
          optimalLineupData.lineup.forEach(player => {
            const statusIcon = player.injury !== 'Healthy' ? 'üü°' : '‚úÖ';
            lineupHTML += `<p>${statusIcon} <strong>${player.lineupPosition}:</strong> ${player.name} (${player.team}) - ${player.projection} pts</p>`;
          });
          
          lineupHTML += `<hr><p style="color: #4ade80; font-weight: bold">Total: ${optimalLineupData.totalProjection.toFixed(1)} points</p>`;
          startingLineupDiv.innerHTML = lineupHTML;
        }
        
        // Update bench players display
        const benchDiv = document.getElementById('bench-players-display');
        if (benchDiv) {
          const benchPlayers = fantasyRosterApp.getBench();
          let benchHTML = '';
          
          benchPlayers.forEach(player => {
            const projection = fantasyRosterApp.getStaticProjection(player);
            const statusIcon = player.injury !== 'Healthy' ? 'üü°' : '‚úÖ';
            benchHTML += `<p>${statusIcon} <strong>${player.position}:</strong> ${player.name} (${player.team}) - ${projection} pts</p>`;
          });
          
          if (benchPlayers.length === 0) {
            benchHTML = '<p>No bench players</p>';
          }
          
          benchDiv.innerHTML = benchHTML;
        }
        
        // Update roster stats
        const statsDiv = document.getElementById('roster-stats-display');
        if (statsDiv && currentRoster) {
          let statsHTML = `<p><strong>Team:</strong> ${currentRoster.teamName}</p>`;
          statsHTML += `<p><strong>Record:</strong> ${currentRoster.record.wins}-${currentRoster.record.losses}</p>`;
          statsHTML += `<p><strong>Points For:</strong> ${currentRoster.pointsFor}</p>`;
          statsHTML += `<p><strong>Playoff Seed:</strong> #${currentRoster.playoffSeed}</p>`;
          statsHTML += `<p><strong>Draft Position:</strong> ${currentRoster.draftPosition}</p>`;
          
          // Add strengths/weaknesses
          if (rosterAnalysis) {
            if (rosterAnalysis.strengths.length > 0) {
              statsHTML += `<p style="color: #4ade80">üí™ ${rosterAnalysis.strengths[0]}</p>`;
            }
            if (rosterAnalysis.weaknesses.length > 0) {
              statsHTML += `<p style="color: #f97316">‚ö†Ô∏è ${rosterAnalysis.weaknesses[0]}</p>`;
            }
          }
          
          statsDiv.innerHTML = statsHTML;
        }
        
        // Update sit/start recommendations
        const sitStartDiv = document.getElementById('sit-start-display');
        if (sitStartDiv) {
          let recommendationsHTML = '';
          
          if (optimalLineupData && optimalLineupData.recommendations.length > 0) {
            optimalLineupData.recommendations.forEach((rec, index) => {
              recommendationsHTML += `<p><strong>${index + 1}.</strong> ${rec.message}</p>`;
              if (rec.impact) {
                recommendationsHTML += `<p style="color: #4ade80; font-size: 0.9em">   ${rec.impact}</p>`;
              }
            });
          } else {
            recommendationsHTML = '<p>‚úÖ Your current lineup is optimal!</p>';
          }
          
          // Add position-specific recommendations
          sitStartRecommendations.slice(0, 2).forEach(posRec => {
            recommendationsHTML += `<p><strong>${posRec.position}:</strong> Start ${posRec.start.name}</p>`;
          });
          
          sitStartDiv.innerHTML = recommendationsHTML;
        }
        
        console.log('‚úÖ Roster data loaded successfully');
      }

      function showRosterSetupInSection() {
        // Show setup message in roster section
        const rosterElements = [
          'starting-lineup-display',
          'bench-players-display', 
          'roster-stats-display',
          'sit-start-display'
        ];

        rosterElements.forEach((elementId, index) => {
          const element = document.getElementById(elementId);
          if (element) {
            if (index === 0) {
              element.innerHTML = `
                <h4>üèà Get Started!</h4>
                <p>Connect your fantasy account or build your roster to see your lineup here:</p>
                <div style="margin: 15px 0;">
                  <button onclick="window.location.href='connect-accounts.html'" 
                    style="background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 500; display: block; width: 100%; margin-bottom: 10px;">
                    üîó Connect Fantasy Account (Sleeper/ESPN)
                  </button>
                  <button onclick="window.location.href='roster-builder.html'" 
                    style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 500; display: block; width: 100%;">
                    üèà Build Manual Roster
                  </button>
                </div>
              `;
            } else {
              element.innerHTML = '<p>Available after roster setup</p>';
            }
          }
        });
      }

      async function loadSettingsData() {
        if (!fantasyRosterApp) return;
        
        const leagueSettings = fantasyRosterApp.leagueSettings;
        const currentRoster = fantasyRosterApp.getUserRoster();
        
        // Update league settings display
        const leagueSettingsDiv = document.getElementById('league-settings-display');
        if (leagueSettingsDiv) {
          let settingsHTML = '<h4>League Settings</h4>';
          settingsHTML += `<p><strong>Scoring:</strong> ${leagueSettings.scoringType}</p>`;
          settingsHTML += `<p><strong>Teams:</strong> 12 teams</p>`;
          settingsHTML += `<p><strong>Roster Size:</strong> ${leagueSettings.rosterSize} players</p>`;
          
          // Build starting lineup format
          const lineup = Object.entries(leagueSettings.startingLineup)
            .map(([pos, count]) => `${count} ${pos}`)
            .join(', ');
          settingsHTML += `<p><strong>Starting:</strong> ${lineup}</p>`;
          settingsHTML += `<p><strong>Bench:</strong> ${leagueSettings.benchSize} players</p>`;
          
          leagueSettingsDiv.innerHTML = settingsHTML;
        }
        
        // Update waiver settings display
        const waiverSettingsDiv = document.getElementById('waiver-settings-display');
        if (waiverSettingsDiv) {
          let waiverHTML = '<h4>Waiver Settings</h4>';
          waiverHTML += '<p><strong>Type:</strong> FAAB ($100 budget)</p>';
          waiverHTML += '<p><strong>Period:</strong> 2 days</p>';
          waiverHTML += '<p><strong>Resets:</strong> Weekly</p>';
          waiverHTML += '<p><strong>Priority:</strong> Inverse standings</p>';
          
          waiverSettingsDiv.innerHTML = waiverHTML;
        }
        
        // Update playoff settings display
        const playoffSettingsDiv = document.getElementById('playoff-settings-display');
        if (playoffSettingsDiv && currentRoster) {
          let playoffHTML = '<h4>Playoff Settings</h4>';
          playoffHTML += '<p><strong>Teams:</strong> 6 make playoffs</p>';
          playoffHTML += '<p><strong>Weeks:</strong> 15-17</p>';
          playoffHTML += '<p><strong>Championship:</strong> Week 17</p>';
          playoffHTML += `<p style="color: #4ade80"><strong>Your Seed:</strong> #${currentRoster.playoffSeed}</p>`;
          
          playoffSettingsDiv.innerHTML = playoffHTML;
        }
        
        console.log('‚úÖ Settings data loaded');
      }

      async function loadProjectionsData() {
        const projectionsSection = document.getElementById('projections');
        if (!projectionsSection) return;
        
        const projections = await fantasyApp.getPlayerProjections();
        const featureCards = projectionsSection.querySelectorAll('.feature-card');
        
        // Update QB projections
        if (featureCards[0]) {
          const qbs = projections.filter(p => p.position === 'QB').slice(0, 4);
          let qbHTML = '<h4>Top QB Projections (Live)</h4>';
          qbs.forEach(qb => {
            qbHTML += `<p>${qb.name} (${qb.team}): ${qb.projection} pts</p>`;
          });
          featureCards[0].innerHTML = qbHTML;
        }
        
        // Update RB projections
        if (featureCards[1]) {
          const rbs = projections.filter(p => p.position === 'RB').slice(0, 4);
          let rbHTML = '<h4>Top RB Projections (Live)</h4>';
          rbs.forEach(rb => {
            rbHTML += `<p>${rb.name} (${rb.team}): ${rb.projection} pts</p>`;
          });
          featureCards[1].innerHTML = rbHTML;
        }
        
        // Update WR projections
        if (featureCards[2]) {
          const wrs = projections.filter(p => p.position === 'WR').slice(0, 4);
          let wrHTML = '<h4>Top WR Projections (Live)</h4>';
          wrs.forEach(wr => {
            wrHTML += `<p>${wr.name} (${wr.team}): ${wr.projection} pts</p>`;
          });
          featureCards[2].innerHTML = wrHTML;
        }
        
        // Update TE projections
        if (featureCards[3]) {
          const tes = projections.filter(p => p.position === 'TE').slice(0, 4);
          let teHTML = '<h4>Top TE Projections (Live)</h4>';
          tes.forEach(te => {
            teHTML += `<p>${te.name} (${te.team}): ${te.projection} pts</p>`;
          });
          featureCards[3].innerHTML = teHTML;
        }
      }

      async function loadWaiverData() {
        const waiverTargets = await fantasyApp.getWaiverWireTargets();
        const waiverSection = document.getElementById('waivers');
        if (!waiverSection) return;
        
        const featureCards = waiverSection.querySelectorAll('.feature-card');
        
        // Update breakout candidates
        if (featureCards[1]) {
          const breakouts = waiverTargets.filter(t => t.score > 85).slice(0, 3);
          let breakoutHTML = '<h4>Breakout Candidates (Live)</h4>';
          breakouts.forEach(player => {
            breakoutHTML += `<p>${player.name} (${player.position}, ${player.team}) - ${player.reasoning}</p>`;
          });
          featureCards[1].innerHTML = breakoutHTML;
        }

        // Update injury replacements with live injury data
        if (featureCards[2] && fantasyNewsApp) {
          const injuries = fantasyNewsApp.getInjuryAlerts();
          const waiverNews = fantasyNewsApp.getWaiverWireNews();
          
          let injuryHTML = '<h4>Injury Replacements (Live)</h4>';
          
          injuries.slice(0, 2).forEach(injury => {
            const icon = fantasyNewsApp.getStatusIcon(injury.gameStatus);
            injuryHTML += `<p>${icon} Monitor ${injury.player} (${injury.injury})</p>`;
          });
          
          if (waiverNews.length > 0) {
            injuryHTML += `<p>üìà ${waiverNews[0].headline}</p>`;
          }
          
          featureCards[2].innerHTML = injuryHTML;
        }
        
        // Update trending up
        if (featureCards[3]) {
          const trending = waiverTargets.slice(0, 3);
          let trendHTML = '<h4>Trending Up (Live)</h4>';
          trending.forEach(player => {
            trendHTML += `<p>${player.name} (${player.position}, ${player.team}) ${player.trending}</p>`;
          });
          featureCards[3].innerHTML = trendHTML;
        }
      }

      async function loadTradeData() {
        const tradesSection = document.getElementById('trades');
        if (!tradesSection || !fantasyRosterApp) return;
        
        const featureCards = tradesSection.querySelectorAll('.feature-card');
        const currentRoster = fantasyRosterApp.getUserRoster();
        const starters = fantasyRosterApp.getStartingLineup();
        
        // Update trade opportunities with mock suggestions
        if (featureCards[0] && starters.length > 0) {
          let opportunitiesHTML = '<h4>Trade Opportunities</h4>';
          opportunitiesHTML += '<p><em>Analyze trades based on your roster:</em></p>';
          
          // Find a player to potentially trade
          const tradeablePlayer = starters.find(p => p.position === 'WR' || p.position === 'RB');
          if (tradeablePlayer) {
            const projection = fantasyRosterApp.getStaticProjection(tradeablePlayer);
            opportunitiesHTML += `<p>Consider trading ${tradeablePlayer.name}</p>`;
            opportunitiesHTML += `<p style="color: #fbbf24">Current Value: ${projection} pts/week</p>`;
          }
          
          opportunitiesHTML += '<p>üí° Look for 2-for-1 upgrades</p>';
          opportunitiesHTML += '<p>üéØ Target playoff schedule matchups</p>';
          
          featureCards[0].innerHTML = opportunitiesHTML;
        }
        
        // Update player values from user roster
        if (featureCards[1] && starters.length > 0) {
          let valuesHTML = '<h4>Your Player Values</h4>';
          
          const topPlayers = starters
            .sort((a, b) => fantasyRosterApp.getStaticProjection(b) - fantasyRosterApp.getStaticProjection(a))
            .slice(0, 4);
            
          topPlayers.forEach(player => {
            const projection = fantasyRosterApp.getStaticProjection(player);
            const tradeValue = Math.round(projection * 1.2 * 10) / 10;
            valuesHTML += `<p>${player.name}: ${tradeValue} trade points</p>`;
          });
          
          featureCards[1].innerHTML = valuesHTML;
        }
        
        // Update trade calculator with user context
        if (featureCards[2]) {
          let calculatorHTML = '<h4>Trade Calculator</h4>';
          calculatorHTML += `<p><strong>Your Team:</strong> ${currentRoster.teamName}</p>`;
          calculatorHTML += `<p><strong>Record:</strong> ${currentRoster.record.wins}-${currentRoster.record.losses}</p>`;
          calculatorHTML += '<p>üìä Rest-of-season projections</p>';
          calculatorHTML += '<p>üìÖ Playoff schedule analysis</p>';
          calculatorHTML += '<p>‚öñÔ∏è Position scarcity factors</p>';
          
          featureCards[2].innerHTML = calculatorHTML;
        }
        
        // Update trade tips with relevant news and roster insights
        if (featureCards[3]) {
          let tipsHTML = '<h4>Trade Tips (Your Team)</h4>';
          
          // Add injury-based trade advice from user roster
          const injuredPlayers = currentRoster.roster.filter(p => p.injury && p.injury !== 'Healthy');
          if (injuredPlayers.length > 0) {
            const injuredPlayer = injuredPlayers[0];
            tipsHTML += `<p>üí° Monitor ${injuredPlayer.name} (${injuredPlayer.injury})</p>`;
          }
          
          // Add roster-specific advice
          if (currentRoster.playoffSeed <= 4) {
            tipsHTML += '<p>üéØ You\'re in playoff position - trade for consistency</p>';
          } else {
            tipsHTML += '<p>‚ö° Take calculated risks for upside</p>';
          }
          
          // Add news-based insights if available
          if (fantasyNewsApp) {
            const tradeNews = fantasyNewsApp.getTradeNews();
            if (tradeNews.length > 0) {
              tipsHTML += `<p>üì∞ ${tradeNews[0].headline}</p>`;
            }
          }
          
          // Default trade tips
          tipsHTML += '<p>üìà Consider playoff schedules for trade timing</p>';
          tipsHTML += '<p>‚è∞ Trade deadline approaches - act quickly</p>';
          
          featureCards[3].innerHTML = tipsHTML;
        }
        
        console.log('‚úÖ Trade data loaded with user roster context');
      }

      function forceLoadRosterData() {
        // Force load roster data immediately
        const rosterManager = window.fantasyRosterManager;
        if (!rosterManager) return;

        const roster = rosterManager.getUserRoster();
        if (!roster) return;

        console.log(`üéØ Loading data for: ${roster.teamName}`);

        // Update dashboard immediately with roster data
        const lineupCard = document.querySelector('#dashboard .feature-card');
        if (lineupCard) {
          let html = `<h4>${roster.teamName} - Your Team</h4>`;
          html += `<p><strong>Record:</strong> ${roster.record.wins}-${roster.record.losses}</p>`;
          html += `<p><strong>Playoff Seed:</strong> #${roster.playoffSeed}</p>`;
          html += `<p><strong>Points For:</strong> ${roster.pointsFor}</p>`;
          
          // Show starting lineup
          const starters = roster.roster.filter(p => p.status === 'starter' || p.status === 'flex');
          html += `<p><strong>Starters:</strong></p>`;
          starters.slice(0, 4).forEach(player => {
            html += `<p>‚Ä¢ ${player.name} (${player.position}, ${player.team})</p>`;
          });
          
          lineupCard.innerHTML = html;
        }

        // Update injury watch with real data
        const injuryCard = document.querySelector('#dashboard .feature-card:nth-child(3)');
        if (injuryCard) {
          const injured = roster.roster.filter(p => p.injury && p.injury !== 'Healthy');
          let injuryHTML = '<h4>Injury Watch (Your Players)</h4>';
          
          if (injured.length > 0) {
            injured.forEach(player => {
              injuryHTML += `<p>‚ö†Ô∏è ${player.name} (${player.injury})</p>`;
            });
          } else {
            injuryHTML += '<p>‚úÖ No injury concerns with your players</p>';
          }
          
          injuryCard.innerHTML = injuryHTML;
        }
      }

      function loadFallbackData() {
        console.log('üìù No roster found - showing empty state');
        
        // Update dashboard with no-roster message
        const lineupCard = document.querySelector('#dashboard .feature-card');
        if (lineupCard) {
          let html = '<h4>No Roster Found</h4>';
          html += '<p style="color: #fbbf24;">‚ö†Ô∏è You need to build your roster first!</p>';
          html += '<p>Click the <strong>"üë• Build Your Roster"</strong> button above to:</p>';
          html += '<p>‚Ä¢ Add your fantasy players</p>';
          html += '<p>‚Ä¢ Set your team name and record</p>';
          html += '<p>‚Ä¢ Get personalized recommendations</p>';
          html += '<br>';
          html += '<a href="roster-builder.html" style="background: #667eea; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">Build Roster Now</a>';
          
          lineupCard.innerHTML = html;
        }

        // Update other cards with empty messages
        const matchupCard = document.querySelector('#dashboard .feature-card:nth-child(2)');
        if (matchupCard) {
          matchupCard.innerHTML = '<h4>This Week\'s Matchups</h4><p>Add players to see matchup analysis</p>';
        }

        const injuryCard = document.querySelector('#dashboard .feature-card:nth-child(3)');
        if (injuryCard) {
          injuryCard.innerHTML = '<h4>Injury Watch</h4><p>Add players to monitor injury status</p>';
        }

        const newsCard = document.querySelector('#dashboard .feature-card:nth-child(4)');
        if (newsCard) {
          newsCard.innerHTML = '<h4>Breaking Fantasy News</h4><p>Add players to get personalized news</p>';
        }

        // Update status
        const statusElement = document.getElementById('status');
        if (statusElement) {
          statusElement.textContent = '‚ö†Ô∏è No roster found - Build your roster to get started';
          statusElement.style.color = '#fbbf24';
        }
      }

      // Show dashboard by default and force load data immediately
      setTimeout(function () {
        showSection("dashboard");
        
        // Force immediate data loading for testing
        if (window.fantasyRosterManager) {
          console.log('üîß Force loading roster data...');
          forceLoadRosterData();
        } else {
          console.warn('‚ö†Ô∏è Roster manager not available, loading fallback');
          loadFallbackData();
        }
      }, 500);

      // Add click feedback
      var cards = document.querySelectorAll(".nav-card");
      for (var i = 0; i < cards.length; i++) {
        cards[i].addEventListener("click", function () {
          var card = this;
          card.style.transform = "translateY(-5px) scale(0.98)";
          setTimeout(function () {
            card.style.transform = "translateY(-5px) scale(1)";
          }, 150);
        });
      }

      // Debug functions for testing
      window.debugFantasyHub = function() {
        console.log('üîç Debug Fantasy Hub:');
        console.log('fantasyRosterManager:', !!window.fantasyRosterManager);
        console.log('fantasyDataService:', !!window.fantasyDataService);
        console.log('fantasyNewsService:', !!window.fantasyNewsService);
        
        if (window.fantasyRosterManager) {
          const roster = window.fantasyRosterManager.getUserRoster();
          console.log('Current roster:', roster?.teamName || 'None');
          console.log('Roster players:', roster?.roster?.length || 0);
        }
        
        // Force reload data
        console.log('üîÑ Force reloading data...');
        if (window.fantasyRosterManager) {
          forceLoadRosterData();
        } else {
          loadFallbackData();
        }
      };

      // Clear any old demo data on first load
      if (localStorage.getItem('clearDemoData') !== 'true') {
        console.log('üßπ Clearing any old demo data...');
        localStorage.removeItem('userFantasyRoster');
        localStorage.setItem('clearDemoData', 'true');
      }

      // Auto-debug after 2 seconds
      setTimeout(() => {
        console.log('üöÄ Auto-debugging Fantasy Hub...');
        window.debugFantasyHub();
      }, 2000);
    </script>
  </body>
</html>
