<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• REAL API CALLS TEST</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: white; }
        .container { max-width: 1200px; margin: 0 auto; }
        .result { margin: 15px 0; padding: 15px; border-radius: 5px; }
        .success { background: #1a2a1a; border-left: 4px solid #51cf66; }
        .error { background: #2a1a1a; border-left: 4px solid #ff6b6b; }
        .info { background: #1a1a2a; border-left: 4px solid #74c0fc; }
        .btn { padding: 12px 24px; background: #ff4444; color: white; border: none; border-radius: 6px; cursor: pointer; margin: 10px; }
        h1 { color: #ff4444; text-align: center; }
        .game { background: #2a2a2a; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .live { border-left: 4px solid #ff4444; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• REAL API CALLS TEST</h1>
        <p style="text-align: center; color: #ccc;">Testing actual ESPN API calls to see what's available RIGHT NOW</p>
        
        <div style="text-align: center;">
            <button class="btn" onclick="testESPNScoreboard()">üì° ESPN Scoreboard</button>
            <button class="btn" onclick="testESPNWithDate()">üìÖ ESPN with Date</button>
            <button class="btn" onclick="testProxy()">üîß Test Proxy</button>
            <button class="btn" onclick="testAll()">üöÄ Test All</button>
        </div>
        
        <div id="results"></div>
    </div>

    <script>
        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        async function testESPNScoreboard() {
            addResult('üì° Testing ESPN College Football Scoreboard...', 'info');
            
            try {
                const espnUrl = 'https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard';
                const proxyUrl = `/api/proxy?url=${encodeURIComponent(espnUrl)}`;
                
                addResult(`üîó Proxy URL: ${proxyUrl}`, 'info');
                
                const response = await fetch(proxyUrl);
                addResult(`üìä Response Status: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    addResult(`üìä Data Type: ${typeof data}`, 'info');
                    addResult(`üìä Has Events: ${!!(data && data.events)}`, 'info');
                    
                    if (data && data.events) {
                        addResult(`üèà Total Games Found: ${data.events.length}`, 'success');
                        
                        let liveCount = 0;
                        let scheduledCount = 0;
                        let completedCount = 0;
                        
                        data.events.forEach((event, index) => {
                            const competition = event.competitions && event.competitions[0];
                            if (competition) {
                                const homeTeam = competition.competitors?.find(c => c.homeAway === 'home');
                                const awayTeam = competition.competitors?.find(c => c.homeAway === 'away');
                                const isLive = event.status?.type?.name === 'STATUS_IN_PROGRESS';
                                const isCompleted = event.status?.type?.completed;
                                
                                if (isLive) liveCount++;
                                else if (isCompleted) completedCount++;
                                else scheduledCount++;
                                
                                const gameClass = isLive ? 'live' : '';
                                const liveIndicator = isLive ? 'üî¥ LIVE: ' : '';
                                
                                addResult(`
                                    <div class="game ${gameClass}">
                                        ${liveIndicator}<strong>${event.name || event.shortName}</strong><br>
                                        Score: ${awayTeam?.team?.displayName || 'Away'} ${awayTeam?.score || 0} - ${homeTeam?.score || 0} ${homeTeam?.team?.displayName || 'Home'}<br>
                                        Status: ${event.status?.type?.description || 'Unknown'} ${event.status?.displayClock || ''}<br>
                                        Venue: ${competition.venue?.fullName || 'TBD'}
                                    </div>
                                `, isLive ? 'success' : 'info');
                            }
                        });
                        
                        addResult(`üìä Game Summary: ${liveCount} Live ‚Ä¢ ${scheduledCount} Scheduled ‚Ä¢ ${completedCount} Completed`, 'success');
                        
                        if (liveCount > 0) {
                            addResult(`üî• FOUND ${liveCount} LIVE COLLEGE FOOTBALL GAMES!`, 'success');
                        } else {
                            addResult('‚ÑπÔ∏è No live games currently (this is normal during off-season or between games)', 'info');
                        }
                    } else {
                        addResult('‚ö†Ô∏è No events found in ESPN response', 'error');
                    }
                } else {
                    const errorText = await response.text();
                    addResult(`‚ùå ESPN API Error: ${errorText}`, 'error');
                }
                
            } catch (error) {
                addResult(`‚ùå Network Error: ${error.message}`, 'error');
            }
        }

        async function testESPNWithDate() {
            addResult('üìÖ Testing ESPN with specific date...', 'info');
            
            try {
                const today = new Date();
                const dateStr = today.toISOString().slice(0, 10).replace(/-/g, '');
                const espnUrl = `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=${dateStr}`;
                const proxyUrl = `/api/proxy?url=${encodeURIComponent(espnUrl)}`;
                
                addResult(`üìÖ Date: ${dateStr} (${today.toLocaleDateString()})`, 'info');
                
                const response = await fetch(proxyUrl);
                
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data && data.events) {
                        addResult(`üìÖ Games for ${today.toLocaleDateString()}: ${data.events.length}`, 'success');
                        
                        data.events.forEach(event => {
                            const isLive = event.status?.type?.name === 'STATUS_IN_PROGRESS';
                            if (isLive) {
                                addResult(`üî¥ LIVE TODAY: ${event.name}`, 'success');
                            }
                        });
                    } else {
                        addResult('üìÖ No games found for today', 'info');
                    }
                } else {
                    addResult(`‚ùå Date-specific API failed: ${response.status}`, 'error');
                }
                
            } catch (error) {
                addResult(`‚ùå Date API Error: ${error.message}`, 'error');
            }
        }

        async function testProxy() {
            addResult('üîß Testing proxy functionality...', 'info');
            
            try {
                // Test with a simple endpoint first
                const testUrl = 'https://httpbin.org/json';
                const proxyUrl = `/api/proxy?url=${encodeURIComponent(testUrl)}`;
                
                const response = await fetch(proxyUrl);
                
                if (response.ok) {
                    const data = await response.json();
                    addResult('‚úÖ Proxy is working correctly', 'success');
                } else {
                    addResult(`‚ùå Proxy test failed: ${response.status}`, 'error');
                }
                
            } catch (error) {
                addResult(`‚ùå Proxy Error: ${error.message}`, 'error');
            }
        }

        async function testAll() {
            document.getElementById('results').innerHTML = '';
            addResult('üöÄ Running all tests...', 'info');
            
            await testProxy();
            await testESPNScoreboard();
            await testESPNWithDate();
            
            addResult('‚úÖ All tests completed!', 'success');
        }

        // Auto-run on page load
        window.addEventListener('load', function() {
            setTimeout(testESPNScoreboard, 1000);
        });
    </script>
</body>
</html>